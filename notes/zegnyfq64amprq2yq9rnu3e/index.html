<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Nmap</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Nmap"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://tysonnguyen.github.io/IBM-cybersecurity/notes/zegnyfq64amprq2yq9rnu3e/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="6/10/2022"/><meta property="article:modified_time" content="6/19/2022"/><link rel="canonical" href="https://tysonnguyen.github.io/IBM-cybersecurity/notes/zegnyfq64amprq2yq9rnu3e/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" as="style"/><link rel="stylesheet" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/IBM-cybersecurity/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/IBM-cybersecurity/_next/static/chunks/webpack-b7a0bb0748951285.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/main-3d5e78ffcdd2778f.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/_app-b0ef1900ae658bfa.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/78-13ae6acd5ce7ca5b.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/373-2f3879190a46a3d9.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/notes/%5Bid%5D-69449972c2a725d8.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_buildManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_ssgManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="nmap"><a aria-hidden="true" class="anchor-heading icon-link" href="#nmap"></a>Nmap</h1>
<h1 id="introduction-to-nmap"><a aria-hidden="true" class="anchor-heading icon-link" href="#introduction-to-nmap"></a>Introduction to Nmap</h1>
<p>When it comes to hacking, knowledge is power. The more knowledge about a target system or network, the more options are available.</p>
<ul>
<li>'Map' or landscape is called port scanning.
<ul>
<li>When a computer runs a network service, it opens a networking construct called a 'port' to receive the connection. Ports are necessary for making multiple network requests or having multiple services available.</li>
</ul>
</li>
<li>Network connections are made between two ports - an open port listening on the server and a randomly selected port on your own computer.
<ul>
<li>When you connect to a web page, your computer may open port 49534 to connect to the server's port 443.</li>
</ul>
</li>
<li><img src="https://i.imgur.com/3XAfRpI.png" alt="ports"></li>
</ul>
<p>Every computer has a total of 65535 available ports; however, many of these are registered as standard ports.</p>
<ul>
<li>For example, a HTTP web service can nearly always be found on port 80 of the server.</li>
<li>HTTPS web service on port 443.</li>
<li>Windows NETBIOS on port 139 and SMB on port 445.</li>
</ul>
<p>We begin any attack with a port scan using a tool called nmap. Nmap will connect to each port of the target in turn. Depending on how the port responds, it can be determined as being open, closed, or filtered (usually by a firewall).</p>
<ul>
<li>nmap is the industry standard and is a powerful tool with its scripting engine which can be used to scan for vulnerabilities, and some perform exploit directly.</li>
</ul>
<h2 id="nmap-parameters"><a aria-hidden="true" class="anchor-heading icon-link" href="#nmap-parameters"></a>Nmap Parameters</h2>
<ul>
<li><code>-sS</code> = Syn scan</li>
<li><code>-sU</code> = UDP scan</li>
<li><code>-O</code> = Detect operating system</li>
<li><code>-sV</code> = Detect version of the services running</li>
<li><code>-v</code> = Increase verbosity level 1</li>
<li><code>-vv</code> = Verbosity level 2</li>
<li><code>-oA</code> = Save the nmap results in three major formats</li>
<li><code>-oN</code> = Save nmap results in a 'normal' format
<ul>
<li><code>-oG</code> = A useful output to save results in a 'grepable' format</li>
</ul>
</li>
<li><code>-A</code> = Aggressive mode to activate service detection, operating system detection, traceroute and common script scanning.</li>
<li><code>-T5</code> = Set timing template to increase the speed scans run at to level 5.</li>
<li><code>-p 80</code> = Scan only port 80</li>
<li><code>-p 1000-1500</code> = Scan ports 1000-1500</li>
<li><code>-p-</code> = Scan all ports</li>
<li><code>--script</code> = Activate a script from the nmap scripting library</li>
<li><code>--script=vuln</code> = Activate all the scripts in the 'vuln' category</li>
</ul>
<h2 id="scan-types-overview"><a aria-hidden="true" class="anchor-heading icon-link" href="#scan-types-overview"></a>Scan Types Overview</h2>
<p>Three basics scan types when port scanning with Nmap:</p>
<ol>
<li>TCP Connect Scans (<code>-sT</code>)</li>
<li>SYN 'Half-open' Scans (<code>-sS</code>)</li>
<li>UDP Scans (<code>-sU</code>)</li>
</ol>
<p>Additionally, there are several less common port scans:</p>
<ul>
<li>TCP Null Scans (<code>-sN</code>)</li>
<li>TCP FIN Scans (<code>sF</code>)</li>
<li>TCP Xmas Scans (<code>sX</code>)</li>
</ul>
<p>Most of these are used for very similar purposes but differs between each scan.</p>
<h3 id="tcp-connect-scans"><a aria-hidden="true" class="anchor-heading icon-link" href="#tcp-connect-scans"></a>TCP Connect Scans</h3>
<p>Understanding the TCP three-way handshake when doing TCP Connect scans <code>-sT</code>.</p>
<ol>
<li>The attacking machine sends a TCP request to the target server with the SYN flag set.</li>
<li>The server acknowledges this packet with a TCP response containing the SYN flag, as well as the ACK flag.</li>
<li>Completes the handshake by sending a TCP request with the ACK flag set.</li>
</ol>
<p><img src="https://muirlandoracle.co.uk/wp-content/uploads/2020/03/image-2.png" alt="handshake"></p>
<p>If the port is closed, the target server will respond with a TCP packet with the <em>RST (Reset)</em> flag set.</p>
<ul>
<li>Many firewalls are configured to drop incoming packets. Nmap sends a TCP SYN request, and receives nothing back. This indicates the port is being protected by a firewall and the port is considered to be <em>filtered</em> - if the port is open and hidden behind a firewall</li>
</ul>
<h3 id="syn-scans"><a aria-hidden="true" class="anchor-heading icon-link" href="#syn-scans"></a>SYN Scans</h3>
<p>SYN scans are sometimes referred to as 'half-open' or 'stealth' scans.</p>
<p>TCP scans perform a full three-way-handshake with the target and SYN scans sends back a RST TCP packet after receiving SYN/ACK from the server.</p>
<h4 id="advantages"><a aria-hidden="true" class="anchor-heading icon-link" href="#advantages"></a>Advantages</h4>
<ul>
<li>Bypass older Intrusion Detection systems as they look for a full three-way-handshake.
<ul>
<li>No longer the case with modern IDS solutions.</li>
<li>SYN scans are often not logged by applications listening on open ports, as standard practice is to log a connection once it has been fully established.</li>
</ul>
</li>
<li>Scans are significantly faster than a standard TCP Connect scan.</li>
</ul>
<h4 id="disadvantages"><a aria-hidden="true" class="anchor-heading icon-link" href="#disadvantages"></a>Disadvantages</h4>
<ul>
<li>Require sudo permissions to work correctly in Linux. SYN scans require the ability to create raw packets (opposed to the full TCP handshake).</li>
<li>Unstable services are sometimes brought down by SYN scans - problematic if a client is a production environment.</li>
</ul>
<p>All the pros outweigh the cons since SYN scans are the default scans used by Nmap <em>if run with sudo permissions</em>.</p>
<h3 id="udp-scans"><a aria-hidden="true" class="anchor-heading icon-link" href="#udp-scans"></a>UDP Scans</h3>
<p>Unlike TCP, UDP connections are <em>stateless</em>. UDP connections rely on sending packets to a target port and essentially hoping they make it.</p>
<ul>
<li>UDP is best for connections which rely on speed over quality (e.g. video sharing) but the lack of acknowledgement makes more difficult and slower to scan.</li>
</ul>
<p>When a packet is sent to an open UDP port, there should be no response. Nmap refers to the port as being <code>open|filtered</code>.</p>
<p>When a packet is sent to a closed UDP port, the target should respond with an ICMP (ping) packet containing a message that the port is unreachable.</p>
<h3 id="icmp-network-scanning"><a aria-hidden="true" class="anchor-heading icon-link" href="#icmp-network-scanning"></a>ICMP Network Scanning</h3>
<p>Purpose to see which IP addresses contain active hosts, and which do not.</p>
<p>Nmap can perform a "ping sweep" to send ICMP packet to each possible IP address for the specified network.</p>
<ul>
<li>When it receives a response, it marks the IP address that responded as being alive.</li>
<li>Perform a ping sweep with <code>nmap -sn 192.168.0.1-254</code> on IP ranges specified with a hyphen or CIDR notation.
<ul>
<li><code>-sn</code> tells Nmap not to scan any ports - forcing it to only ICMP echo packets to identify targets.</li>
</ul>
</li>
</ul>
<h2 id="nse-scripts-overview"><a aria-hidden="true" class="anchor-heading icon-link" href="#nse-scripts-overview"></a>NSE Scripts Overview</h2>
<p>The Nmap Scripting Engine (NSE) is an incredible powerful addition to Nmap. NSE scripts are written in the Lua programming language, and can be used for a variety of things: scanning for vulnerabilities, to automating exploits for them. NSE is useful for reconnaissance and includes many categories:</p>
<ul>
<li><code>safe</code> - Will not affect the target</li>
<li><code>intrusive</code> - Not safe: likely to affect the target</li>
<li><code>vuln</code> - Scan for vulnerabilities</li>
<li><code>exploit</code> - Attempt to exploit a vulnerability</li>
<li><code>auth</code> - Attempt to bypass authentication for running services</li>
<li><code>brute</code> - Attempt to brute force credentials for running services</li>
<li><code>discovery</code> - Attempt to query running services for further information about the network</li>
</ul>
<p>A more detailed list can be found <a href="https://nmap.org/book/nse-usage.html">here</a>.</p>
<h3 id="working-with-the-nse"><a aria-hidden="true" class="anchor-heading icon-link" href="#working-with-the-nse"></a>Working with the NSE</h3>
<ul>
<li><code>--script=safe</code> will run any applicable safe scripts against the target or any specified category.</li>
<li>To run a specific script, we would use <code>--script=&#x3C;script-name></code>.
<ul>
<li>Multiple scripts can be run simultaneously by separating them by a comma.</li>
</ul>
</li>
</ul>
<p>A full list of scripts and example use cases can be found <a href="https://nmap.org/nsedoc/">here</a>.</p>
<h3 id="searching-for-scripts"><a aria-hidden="true" class="anchor-heading icon-link" href="#searching-for-scripts"></a>Searching for Scripts</h3>
<p>All of the official scripts on Linux at <code>/usr/share/nmap/scripts</code>.</p>
<ul>
<li>Use grep to look for scripts: <code>grep 'ftp' /usr/share/nmap/scripts/script.db</code></li>
<li>Use <code>ls</code>: <code>ls -l /usr/share/nmap/scripts/*ftp*</code></li>
</ul>
<h3 id="installing-new-scripts"><a aria-hidden="true" class="anchor-heading icon-link" href="#installing-new-scripts"></a>Installing New Scripts</h3>
<p>It is possible to install the scripts manually by downloading the script from Nmap (<code>sudo wget -O /usr/share/nmap/scripts/&#x3C;script-name>.nse https://svn.nmap.org/nmap/scripts/&#x3C;script-name>.nse</code>)</p>
<ul>
<li>This must be followed up with <code>nmap --script-updatedb</code> which updates the <em>script.db</em> file to contain the new downloaded script.</li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#introduction-to-nmap" title="Introduction to Nmap">Introduction to Nmap</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#nmap-parameters" title="Nmap Parameters">Nmap Parameters</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#scan-types-overview" title="Scan Types Overview">Scan Types Overview</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tcp-connect-scans" title="TCP Connect Scans">TCP Connect Scans</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#syn-scans" title="SYN Scans">SYN Scans</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#advantages" title="Advantages">Advantages</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#disadvantages" title="Disadvantages">Disadvantages</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#udp-scans" title="UDP Scans">UDP Scans</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#icmp-network-scanning" title="ICMP Network Scanning">ICMP Network Scanning</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#nse-scripts-overview" title="NSE Scripts Overview">NSE Scripts Overview</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#working-with-the-nse" title="Working with the NSE">Working with the NSE</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#searching-for-scripts" title="Searching for Scripts">Searching for Scripts</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#installing-new-scripts" title="Installing New Scripts">Installing New Scripts</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"zegnyfq64amprq2yq9rnu3e","title":"Nmap","desc":"","updated":1655599671365,"created":1654835317617,"custom":{},"fname":"nmap","type":"note","vault":{"fsPath":"vault"},"contentHash":"27b0386a80cf00b088dd1a82aa0055ab","links":[],"anchors":{"introduction-to-nmap":{"type":"header","text":"Introduction to Nmap","value":"introduction-to-nmap","line":8,"column":0,"depth":1},"nmap-parameters":{"type":"header","text":"Nmap Parameters","value":"nmap-parameters","line":28,"column":0,"depth":2},"scan-types-overview":{"type":"header","text":"Scan Types Overview","value":"scan-types-overview","line":47,"column":0,"depth":2},"tcp-connect-scans":{"type":"header","text":"TCP Connect Scans","value":"tcp-connect-scans","line":63,"column":0,"depth":3},"syn-scans":{"type":"header","text":"SYN Scans","value":"syn-scans","line":78,"column":0,"depth":3},"advantages":{"type":"header","text":"Advantages","value":"advantages","line":84,"column":0,"depth":4},"disadvantages":{"type":"header","text":"Disadvantages","value":"disadvantages","line":91,"column":0,"depth":4},"udp-scans":{"type":"header","text":"UDP Scans","value":"udp-scans","line":98,"column":0,"depth":3},"icmp-network-scanning":{"type":"header","text":"ICMP Network Scanning","value":"icmp-network-scanning","line":108,"column":0,"depth":3},"nse-scripts-overview":{"type":"header","text":"NSE Scripts Overview","value":"nse-scripts-overview","line":118,"column":0,"depth":2},"working-with-the-nse":{"type":"header","text":"Working with the NSE","value":"working-with-the-nse","line":132,"column":0,"depth":3},"searching-for-scripts":{"type":"header","text":"Searching for Scripts","value":"searching-for-scripts","line":140,"column":0,"depth":3},"installing-new-scripts":{"type":"header","text":"Installing New Scripts","value":"installing-new-scripts","line":147,"column":0,"depth":3}},"children":[],"parent":"3ipqfkgudo2s73dwa256ca0","data":{}},"body":"\u003ch1 id=\"nmap\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#nmap\"\u003e\u003c/a\u003eNmap\u003c/h1\u003e\n\u003ch1 id=\"introduction-to-nmap\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#introduction-to-nmap\"\u003e\u003c/a\u003eIntroduction to Nmap\u003c/h1\u003e\n\u003cp\u003eWhen it comes to hacking, knowledge is power. The more knowledge about a target system or network, the more options are available.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e'Map' or landscape is called port scanning.\n\u003cul\u003e\n\u003cli\u003eWhen a computer runs a network service, it opens a networking construct called a 'port' to receive the connection. Ports are necessary for making multiple network requests or having multiple services available.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eNetwork connections are made between two ports - an open port listening on the server and a randomly selected port on your own computer.\n\u003cul\u003e\n\u003cli\u003eWhen you connect to a web page, your computer may open port 49534 to connect to the server's port 443.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cimg src=\"https://i.imgur.com/3XAfRpI.png\" alt=\"ports\"\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eEvery computer has a total of 65535 available ports; however, many of these are registered as standard ports.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFor example, a HTTP web service can nearly always be found on port 80 of the server.\u003c/li\u003e\n\u003cli\u003eHTTPS web service on port 443.\u003c/li\u003e\n\u003cli\u003eWindows NETBIOS on port 139 and SMB on port 445.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWe begin any attack with a port scan using a tool called nmap. Nmap will connect to each port of the target in turn. Depending on how the port responds, it can be determined as being open, closed, or filtered (usually by a firewall).\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003enmap is the industry standard and is a powerful tool with its scripting engine which can be used to scan for vulnerabilities, and some perform exploit directly.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"nmap-parameters\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#nmap-parameters\"\u003e\u003c/a\u003eNmap Parameters\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-sS\u003c/code\u003e = Syn scan\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-sU\u003c/code\u003e = UDP scan\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-O\u003c/code\u003e = Detect operating system\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-sV\u003c/code\u003e = Detect version of the services running\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-v\u003c/code\u003e = Increase verbosity level 1\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-vv\u003c/code\u003e = Verbosity level 2\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-oA\u003c/code\u003e = Save the nmap results in three major formats\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-oN\u003c/code\u003e = Save nmap results in a 'normal' format\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-oG\u003c/code\u003e = A useful output to save results in a 'grepable' format\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-A\u003c/code\u003e = Aggressive mode to activate service detection, operating system detection, traceroute and common script scanning.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-T5\u003c/code\u003e = Set timing template to increase the speed scans run at to level 5.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-p 80\u003c/code\u003e = Scan only port 80\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-p 1000-1500\u003c/code\u003e = Scan ports 1000-1500\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-p-\u003c/code\u003e = Scan all ports\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e--script\u003c/code\u003e = Activate a script from the nmap scripting library\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e--script=vuln\u003c/code\u003e = Activate all the scripts in the 'vuln' category\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"scan-types-overview\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#scan-types-overview\"\u003e\u003c/a\u003eScan Types Overview\u003c/h2\u003e\n\u003cp\u003eThree basics scan types when port scanning with Nmap:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eTCP Connect Scans (\u003ccode\u003e-sT\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eSYN 'Half-open' Scans (\u003ccode\u003e-sS\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eUDP Scans (\u003ccode\u003e-sU\u003c/code\u003e)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAdditionally, there are several less common port scans:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTCP Null Scans (\u003ccode\u003e-sN\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eTCP FIN Scans (\u003ccode\u003esF\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eTCP Xmas Scans (\u003ccode\u003esX\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eMost of these are used for very similar purposes but differs between each scan.\u003c/p\u003e\n\u003ch3 id=\"tcp-connect-scans\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tcp-connect-scans\"\u003e\u003c/a\u003eTCP Connect Scans\u003c/h3\u003e\n\u003cp\u003eUnderstanding the TCP three-way handshake when doing TCP Connect scans \u003ccode\u003e-sT\u003c/code\u003e.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe attacking machine sends a TCP request to the target server with the SYN flag set.\u003c/li\u003e\n\u003cli\u003eThe server acknowledges this packet with a TCP response containing the SYN flag, as well as the ACK flag.\u003c/li\u003e\n\u003cli\u003eCompletes the handshake by sending a TCP request with the ACK flag set.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://muirlandoracle.co.uk/wp-content/uploads/2020/03/image-2.png\" alt=\"handshake\"\u003e\u003c/p\u003e\n\u003cp\u003eIf the port is closed, the target server will respond with a TCP packet with the \u003cem\u003eRST (Reset)\u003c/em\u003e flag set.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMany firewalls are configured to drop incoming packets. Nmap sends a TCP SYN request, and receives nothing back. This indicates the port is being protected by a firewall and the port is considered to be \u003cem\u003efiltered\u003c/em\u003e - if the port is open and hidden behind a firewall\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"syn-scans\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#syn-scans\"\u003e\u003c/a\u003eSYN Scans\u003c/h3\u003e\n\u003cp\u003eSYN scans are sometimes referred to as 'half-open' or 'stealth' scans.\u003c/p\u003e\n\u003cp\u003eTCP scans perform a full three-way-handshake with the target and SYN scans sends back a RST TCP packet after receiving SYN/ACK from the server.\u003c/p\u003e\n\u003ch4 id=\"advantages\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#advantages\"\u003e\u003c/a\u003eAdvantages\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eBypass older Intrusion Detection systems as they look for a full three-way-handshake.\n\u003cul\u003e\n\u003cli\u003eNo longer the case with modern IDS solutions.\u003c/li\u003e\n\u003cli\u003eSYN scans are often not logged by applications listening on open ports, as standard practice is to log a connection once it has been fully established.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eScans are significantly faster than a standard TCP Connect scan.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"disadvantages\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#disadvantages\"\u003e\u003c/a\u003eDisadvantages\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eRequire sudo permissions to work correctly in Linux. SYN scans require the ability to create raw packets (opposed to the full TCP handshake).\u003c/li\u003e\n\u003cli\u003eUnstable services are sometimes brought down by SYN scans - problematic if a client is a production environment.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAll the pros outweigh the cons since SYN scans are the default scans used by Nmap \u003cem\u003eif run with sudo permissions\u003c/em\u003e.\u003c/p\u003e\n\u003ch3 id=\"udp-scans\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#udp-scans\"\u003e\u003c/a\u003eUDP Scans\u003c/h3\u003e\n\u003cp\u003eUnlike TCP, UDP connections are \u003cem\u003estateless\u003c/em\u003e. UDP connections rely on sending packets to a target port and essentially hoping they make it.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUDP is best for connections which rely on speed over quality (e.g. video sharing) but the lack of acknowledgement makes more difficult and slower to scan.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhen a packet is sent to an open UDP port, there should be no response. Nmap refers to the port as being \u003ccode\u003eopen|filtered\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eWhen a packet is sent to a closed UDP port, the target should respond with an ICMP (ping) packet containing a message that the port is unreachable.\u003c/p\u003e\n\u003ch3 id=\"icmp-network-scanning\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#icmp-network-scanning\"\u003e\u003c/a\u003eICMP Network Scanning\u003c/h3\u003e\n\u003cp\u003ePurpose to see which IP addresses contain active hosts, and which do not.\u003c/p\u003e\n\u003cp\u003eNmap can perform a \"ping sweep\" to send ICMP packet to each possible IP address for the specified network.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen it receives a response, it marks the IP address that responded as being alive.\u003c/li\u003e\n\u003cli\u003ePerform a ping sweep with \u003ccode\u003enmap -sn 192.168.0.1-254\u003c/code\u003e on IP ranges specified with a hyphen or CIDR notation.\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-sn\u003c/code\u003e tells Nmap not to scan any ports - forcing it to only ICMP echo packets to identify targets.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"nse-scripts-overview\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#nse-scripts-overview\"\u003e\u003c/a\u003eNSE Scripts Overview\u003c/h2\u003e\n\u003cp\u003eThe Nmap Scripting Engine (NSE) is an incredible powerful addition to Nmap. NSE scripts are written in the Lua programming language, and can be used for a variety of things: scanning for vulnerabilities, to automating exploits for them. NSE is useful for reconnaissance and includes many categories:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003esafe\u003c/code\u003e - Will not affect the target\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eintrusive\u003c/code\u003e - Not safe: likely to affect the target\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003evuln\u003c/code\u003e - Scan for vulnerabilities\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eexploit\u003c/code\u003e - Attempt to exploit a vulnerability\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eauth\u003c/code\u003e - Attempt to bypass authentication for running services\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ebrute\u003c/code\u003e - Attempt to brute force credentials for running services\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ediscovery\u003c/code\u003e - Attempt to query running services for further information about the network\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA more detailed list can be found \u003ca href=\"https://nmap.org/book/nse-usage.html\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"working-with-the-nse\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#working-with-the-nse\"\u003e\u003c/a\u003eWorking with the NSE\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e--script=safe\u003c/code\u003e will run any applicable safe scripts against the target or any specified category.\u003c/li\u003e\n\u003cli\u003eTo run a specific script, we would use \u003ccode\u003e--script=\u0026#x3C;script-name\u003e\u003c/code\u003e.\n\u003cul\u003e\n\u003cli\u003eMultiple scripts can be run simultaneously by separating them by a comma.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA full list of scripts and example use cases can be found \u003ca href=\"https://nmap.org/nsedoc/\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"searching-for-scripts\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#searching-for-scripts\"\u003e\u003c/a\u003eSearching for Scripts\u003c/h3\u003e\n\u003cp\u003eAll of the official scripts on Linux at \u003ccode\u003e/usr/share/nmap/scripts\u003c/code\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUse grep to look for scripts: \u003ccode\u003egrep 'ftp' /usr/share/nmap/scripts/script.db\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003els\u003c/code\u003e: \u003ccode\u003els -l /usr/share/nmap/scripts/*ftp*\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"installing-new-scripts\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#installing-new-scripts\"\u003e\u003c/a\u003eInstalling New Scripts\u003c/h3\u003e\n\u003cp\u003eIt is possible to install the scripts manually by downloading the script from Nmap (\u003ccode\u003esudo wget -O /usr/share/nmap/scripts/\u0026#x3C;script-name\u003e.nse https://svn.nmap.org/nmap/scripts/\u0026#x3C;script-name\u003e.nse\u003c/code\u003e)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThis must be followed up with \u003ccode\u003enmap --script-updatedb\u003c/code\u003e which updates the \u003cem\u003escript.db\u003c/em\u003e file to contain the new downloaded script.\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"3ipqfkgudo2s73dwa256ca0","title":"Brain","desc":"","updated":1654212603514,"created":1651706375099,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a83b284bd096f5e390fe503b2b0b07c7","links":[{"type":"ref","from":{"fname":"root","id":"3ipqfkgudo2s73dwa256ca0","vaultName":"vault"},"value":"cybersecurity","position":{"start":{"line":5,"column":1,"offset":76},"end":{"line":5,"column":19,"offset":94},"indent":[]},"xvault":false,"to":{"fname":"cybersecurity"}}],"anchors":{"welcome-to-tysons-vault":{"type":"header","text":"Welcome to Tyson's Vault!","value":"welcome-to-tysons-vault","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":14,"column":0,"depth":2}},"children":["nkcab8fkftjfz927no2dyac","cl0utj7thwjp7bsmxe4v5va","o9kgllk4dy29wx2figqoz1w","5vhy4yxl34a7p6064a13u49","ce290z98noyy6eb5pniawk9","txeqnq5eaictderxvuifqr6","pn4fankyf3uifous1txqj5m","8ykaxd1qjsjfi1c6zsfq1eq","017vb349bxpq76wq69sai1u","wcuptt9dpzdx06nt9l6myuv","iulpmov883qv6tpqkgvbno8","8ml5picmbrjw3u887mag9dz","pd3512leoloo1qll6fr2j0o","e77elhqi5fhnpz5kdvxeudb","9k9gs0zqcs40mq2fsi5nesj","zegnyfq64amprq2yq9rnu3e","op8gluer5gorswd1xkdwwis","btat806wf3v71jpa11klryx","kldz5ejn1lvhsujdm2nyog7","9gc4nxd14um87nyud8e9ubt","ptonz0zapnutyahjkedfn8f","ixopv5geql8hlgkwk20pxow","3cschspue6elfiqxcd17tul","0f8xutu1gmbnw7xt51tim9v","87sb4tbzuopxpz736rwtx5b","d9ibeadgk68z3q2qjgsqida","woqkmy53oegpxi1ia3jl833","6ltznv32t1szgyl74knpxly","16md0j2hj1k5477uu3kclcb","2o3i5a96njb0vlfr61lslzi"],"parent":null,"data":{},"body":"# Welcome to Tyson's Vault!\n\nThis is my place store all my cool knowledge.\n\n![[cybersecurity]]\n\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":false,"templateHierarchy":"template","enableSmartRefs":true,"dendronVersion":"0.83.0"},"preview":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"logoPath":"https://clipground.com/images/cyber-logo-3.jpg","theme":"dark","siteUrl":"https://tysonnguyen.github.io","assetsPrefix":"/IBM-cybersecurity","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Cybersecurity","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/TysonNguyen/IBM-cybersecurity"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enablePrettyLinks":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"enableTaskNotes":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"zegnyfq64amprq2yq9rnu3e"},"buildId":"NXb5WjKoAzTxCthMfgKQk","assetPrefix":"/IBM-cybersecurity","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>