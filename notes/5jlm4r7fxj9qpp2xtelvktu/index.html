<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Meterpreter</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Meterpreter"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://tysonnguyen.github.io/IBM-cybersecurity/notes/5jlm4r7fxj9qpp2xtelvktu/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="6/9/2022"/><meta property="article:modified_time" content="6/10/2022"/><link rel="canonical" href="https://tysonnguyen.github.io/IBM-cybersecurity/notes/5jlm4r7fxj9qpp2xtelvktu/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" as="style"/><link rel="stylesheet" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/IBM-cybersecurity/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/IBM-cybersecurity/_next/static/chunks/webpack-b7a0bb0748951285.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/main-3d5e78ffcdd2778f.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/_app-b0ef1900ae658bfa.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/78-13ae6acd5ce7ca5b.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/373-2f3879190a46a3d9.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/notes/%5Bid%5D-69449972c2a725d8.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_buildManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_ssgManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="meterpreter"><a aria-hidden="true" class="anchor-heading icon-link" href="#meterpreter"></a>Meterpreter</h1>
<h1 id="introduction-to-meterpreter"><a aria-hidden="true" class="anchor-heading icon-link" href="#introduction-to-meterpreter"></a>Introduction to Meterpreter</h1>
<p>Meterpreter is a Metasploit payload that supports the penetration testing process with many valuable components.</p>
<ul>
<li>
<p>Meterpreter will run on the target system and act as an agent within a command and control architecture.</p>
</li>
<li>
<p>Interact with the target operating system and use Meterpreter's specialized commands.</p>
</li>
<li>
<p>Meterpreter runs on the target system in memory (RAM - Random Access Memory) to avoid having a file that has to be written to the disk.</p>
<ul>
<li>Meterpreter will be seen as a process and not have a file on the target system.</li>
<li>Aims to avoid being detected by network-based IPS (Intrusion Prevention System) and IDS (Intrusion Detection System) solutions by using encrypted communication with the server where Metasploit runs (typically attacking machine).
<ul>
<li>If the target organization does not decrypt and inspect encrypted traffic (e.g. HTTPS) coming to and going out of the local network, IPS and IDS solutions will not be able to detect its activities.</li>
</ul>
</li>
<li>Recognized by major antivirus software and this provides some degree of stealth.</li>
</ul>
</li>
</ul>
<h2 id="meterpreter-flavors"><a aria-hidden="true" class="anchor-heading icon-link" href="#meterpreter-flavors"></a>Meterpreter Flavors</h2>
<p>Staged payloads are sent to the target in two steps allowing for smaller initial payload size. The inline payloads are sent in a single step.</p>
<ol>
<li>The stager</li>
<li>Requests the rest of the payload
Meterpreter payloads are divided into staged and inline versions.</li>
</ol>
<ul>
<li>Meterpreter has a wide range of different versions to choose from based on the target system.</li>
</ul>
<p><code>msfvenom --list payloads | grep meterpreter</code> to view available Meterpreter versions.</p>
<p>The list will show Meterpreter versions available for the following platforms:</p>
<ul>
<li>Android</li>
<li>Apple iOS</li>
<li>Java</li>
<li>Linux</li>
<li>OSX</li>
<li>PHP</li>
<li>Python</li>
<li>Windows</li>
</ul>
<p>Choosing a version of Meterpreter to use will be based on three factors:</p>
<ol>
<li>Target operating system (Linux, Mac, or Windows, etc.)</li>
<li>Components available on the target system (Is Python installed, PHP website?)</li>
<li>Network connection types on the target system (Do they allow TCP connections? HTTPS reverse connections? Are IPv6 addresses are not closely monitored as IPv4 addresses?)</li>
</ol>
<p>Also list other available payloads using the <code>show payloads</code> command with any module.</p>
<h2 id="meterpreter-commands"><a aria-hidden="true" class="anchor-heading icon-link" href="#meterpreter-commands"></a>Meterpreter Commands</h2>
<p>Meterpreter will provide with three primary categories of tools:</p>
<ul>
<li>Built-in commands</li>
<li>Meterpreter tools</li>
<li>Meterpreter scripting</li>
</ul>
<p>Running the <code>help</code> will show Meterpreter commands for different categories:</p>
<ul>
<li>Core </li>
<li>File system</li>
<li>Networking </li>
<li>System </li>
<li>User interface </li>
<li>Webcam </li>
<li>Audio output</li>
<li>Elevate</li>
<li>Password database</li>
<li>Timestomp</li>
</ul>
<h3 id="core-commands"><a aria-hidden="true" class="anchor-heading icon-link" href="#core-commands"></a>Core Commands</h3>
<ul>
<li><code>background</code>: Backgrounds the current session</li>
<li><code>exit</code>: Terminate the Meterpreter session</li>
<li><code>guid</code>: Get the session GUID (Globally Unique Identifier)</li>
<li><code>help</code>: Displays the help menu</li>
<li><code>info</code>: Displays information about a Post module</li>
<li><code>irb</code>: Opens an interactive Ruby shell on the current session</li>
<li><code>load</code>: Loads one or more Meterpreter extensions</li>
<li><code>migrate</code>: Allows to migrate Meterpreter to another process</li>
<li><code>run</code>: Executes a Meterpreter script or Post module</li>
<li><code>sessions</code>: Quickly switch to another session</li>
</ul>
<h3 id="file-system-commands"><a aria-hidden="true" class="anchor-heading icon-link" href="#file-system-commands"></a>File System Commands</h3>
<ul>
<li><code>cd</code>: Change directory</li>
<li><code>ls</code>: List files in the current directory (dir will also work)</li>
<li><code>pwd</code>: Prints the current working directory</li>
<li><code>edit</code>: Allow to edit a file</li>
<li><code>cat</code>: Show contents of a file to the screen</li>
<li><code>rm</code>: Delete the specified file</li>
<li><code>search</code>: Search for files</li>
<li><code>upload</code>: Upload a file or directory</li>
<li><code>download</code>: Download a file or directory</li>
</ul>
<h3 id="networking-commands"><a aria-hidden="true" class="anchor-heading icon-link" href="#networking-commands"></a>Networking Commands</h3>
<ul>
<li><code>arp</code>: Displays the host ARP (Address Resolution Protocol) cache</li>
<li><code>ifconfig</code>: Displays network interfaces available on the target system</li>
<li><code>netstat</code>: Displays the network connections</li>
<li><code>portfwd</code>: Forwards a local port to a remote service</li>
<li><code>route</code>: Allows to view and modify the routing table</li>
</ul>
<h3 id="system-commands"><a aria-hidden="true" class="anchor-heading icon-link" href="#system-commands"></a>System Commands</h3>
<ul>
<li><code>clearev</code>: Clears the event logs</li>
<li><code>execute</code>: Executes a command</li>
<li><code>getpid</code>: Shows the current process identifier</li>
<li><code>getuid</code>: Shows the user that Meterpreter is running as</li>
<li><code>kill</code>: Terminates a process</li>
<li><code>pkill</code>: Terminates processes by name</li>
<li><code>ps</code>: List running processes</li>
<li><code>reboot</code>: Reboots the remote computer</li>
<li><code>shell</code>: Drops into a system command shell</li>
<li><code>shutdown</code>: Shuts down the remote computer</li>
<li><code>sysinfo</code>: Gets information about the remote system, such as OS</li>
</ul>
<h3 id="others-commands-listed-under-different-categories"><a aria-hidden="true" class="anchor-heading icon-link" href="#others-commands-listed-under-different-categories"></a>Others Commands (listed under different categories)</h3>
<ul>
<li><code>idletime</code>: Returns the number of seconds the remote user has been idle</li>
<li><code>keyscan_dump</code>: Dumps the keystroke buffer</li>
<li><code>keyscan_start</code>: Starts capturing keystrokes</li>
<li><code>keyscan_stop</code>: Stops capturing keystrokes</li>
<li><code>screenshare</code>: Allows to watch the remote user's desktop in real time</li>
<li><code>screenshot</code>: Grabs a screenshot of the interactive desktop</li>
<li><code>record_mic</code>: Records audio from the default microphone for X seconds</li>
<li><code>webcam_chat</code>: Starts a video chat</li>
<li><code>webcam_list</code>: Lists webcams</li>
<li><code>webcam_snap</code>: Takes a snapshot from the specified webcam</li>
<li><code>webcam_stream</code>: Plays a video stream from the specified webcam</li>
<li><code>getsystem</code>: Attempts to elevate privilege to that of a local system</li>
<li><code>hashdump</code>: Dumps the contents of the SAM database</li>
</ul>
<h2 id="post-exploitation-with-meterpreter"><a aria-hidden="true" class="anchor-heading icon-link" href="#post-exploitation-with-meterpreter"></a>Post-Exploitation with Meterpreter</h2>
<p>Meterpreter provides many useful commands for the post-exploitation phase.</p>
<ul>
<li><code>getuid</code> command will display the user which Meterpreter is currently running to give an idea of possible privilege level on the target system.</li>
<li><code>ps</code> command will list running processes. The PID column gives the PID information to migrate Meterpreter to another process.</li>
</ul>
<h3 id="migrate"><a aria-hidden="true" class="anchor-heading icon-link" href="#migrate"></a>Migrate</h3>
<p>Migrating to another process will help Meterpreter interact with it.</p>
<ul>
<li>If you see a word process running on the target (e.g. word.exe, notepad.exe, etc.), can migrate to to it and start capturing keystrokes sent by the user to this process.
<ul>
<li>Careful to lose user privileges from SYSTEM user to a process started by a lower privileged user.</li>
</ul>
</li>
</ul>
<h3 id="hashdump"><a aria-hidden="true" class="anchor-heading icon-link" href="#hashdump"></a>Hashdump</h3>
<p><code>hashdump</code> will list the content of the SAM database.</p>
<ul>
<li>The SAM (Security Account Manager) database stores user's passwords on Windows systems. These passwords are stored in the NTLM (New Technology LAN Manager) format.
<ul>
<li>While not mathematically possible to 'crack' these hashes, can still discover the cleartext password using online NTLM databases or a rainbow table attack.</li>
</ul>
</li>
</ul>
<h3 id="search"><a aria-hidden="true" class="anchor-heading icon-link" href="#search"></a>Search</h3>
<p><code>search</code> is useful to locate files with potential information.</p>
<h3 id="shell"><a aria-hidden="true" class="anchor-heading icon-link" href="#shell"></a>Shell</h3>
<p>A regular command-line shell on the target system. Pressing CTRL+Z will return to the Meterpreter shell</p>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/IBM-cybersecurity/notes/ixopv5geql8hlgkwk20pxow">Shells</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#introduction-to-meterpreter" title="Introduction to Meterpreter">Introduction to Meterpreter</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#meterpreter-flavors" title="Meterpreter Flavors">Meterpreter Flavors</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#meterpreter-commands" title="Meterpreter Commands">Meterpreter Commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#core-commands" title="Core Commands">Core Commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#file-system-commands" title="File System Commands">File System Commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#networking-commands" title="Networking Commands">Networking Commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#system-commands" title="System Commands">System Commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#others-commands-listed-under-different-categories" title="Others Commands (listed under different categories)">Others Commands (listed under different categories)</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#post-exploitation-with-meterpreter" title="Post-Exploitation with Meterpreter">Post-Exploitation with Meterpreter</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#migrate" title="Migrate">Migrate</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#hashdump" title="Hashdump">Hashdump</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#search" title="Search">Search</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#shell" title="Shell">Shell</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"5jlm4r7fxj9qpp2xtelvktu","title":"Meterpreter","desc":"","updated":1654824928287,"created":1654811064385,"custom":{},"fname":"metasploit.meterpreter","type":"note","vault":{"fsPath":"vault"},"contentHash":"83bcd73a7625c159642928757414ba26","links":[{"from":{"fname":"shells","vaultName":"vault"},"type":"backlink","position":{"start":{"line":219,"column":1,"offset":12817},"end":{"line":219,"column":97,"offset":12913},"indent":[]},"value":"metasploit.meterpreter","alias":"Meterpreter shells are Metasploit's own brand of fully-featured shell"}],"anchors":{"introduction-to-meterpreter":{"type":"header","text":"Introduction to Meterpreter","value":"introduction-to-meterpreter","line":8,"column":0,"depth":1},"meterpreter-flavors":{"type":"header","text":"Meterpreter Flavors","value":"meterpreter-flavors","line":21,"column":0,"depth":2},"meterpreter-commands":{"type":"header","text":"Meterpreter Commands","value":"meterpreter-commands","line":52,"column":0,"depth":2},"core-commands":{"type":"header","text":"Core Commands","value":"core-commands","line":73,"column":0,"depth":3},"file-system-commands":{"type":"header","text":"File System Commands","value":"file-system-commands","line":86,"column":0,"depth":3},"networking-commands":{"type":"header","text":"Networking Commands","value":"networking-commands","line":98,"column":0,"depth":3},"system-commands":{"type":"header","text":"System Commands","value":"system-commands","line":106,"column":0,"depth":3},"others-commands-listed-under-different-categories":{"type":"header","text":"Others Commands (listed under different categories)","value":"others-commands-listed-under-different-categories","line":120,"column":0,"depth":3},"post-exploitation-with-meterpreter":{"type":"header","text":"Post-Exploitation with Meterpreter","value":"post-exploitation-with-meterpreter","line":136,"column":0,"depth":2},"migrate":{"type":"header","text":"Migrate","value":"migrate","line":143,"column":0,"depth":3},"hashdump":{"type":"header","text":"Hashdump","value":"hashdump","line":150,"column":0,"depth":3},"search":{"type":"header","text":"Search","value":"search","line":157,"column":0,"depth":3},"shell":{"type":"header","text":"Shell","value":"shell","line":161,"column":0,"depth":3}},"children":[],"parent":"9k9gs0zqcs40mq2fsi5nesj","data":{}},"body":"\u003ch1 id=\"meterpreter\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#meterpreter\"\u003e\u003c/a\u003eMeterpreter\u003c/h1\u003e\n\u003ch1 id=\"introduction-to-meterpreter\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#introduction-to-meterpreter\"\u003e\u003c/a\u003eIntroduction to Meterpreter\u003c/h1\u003e\n\u003cp\u003eMeterpreter is a Metasploit payload that supports the penetration testing process with many valuable components.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMeterpreter will run on the target system and act as an agent within a command and control architecture.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eInteract with the target operating system and use Meterpreter's specialized commands.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMeterpreter runs on the target system in memory (RAM - Random Access Memory) to avoid having a file that has to be written to the disk.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMeterpreter will be seen as a process and not have a file on the target system.\u003c/li\u003e\n\u003cli\u003eAims to avoid being detected by network-based IPS (Intrusion Prevention System) and IDS (Intrusion Detection System) solutions by using encrypted communication with the server where Metasploit runs (typically attacking machine).\n\u003cul\u003e\n\u003cli\u003eIf the target organization does not decrypt and inspect encrypted traffic (e.g. HTTPS) coming to and going out of the local network, IPS and IDS solutions will not be able to detect its activities.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eRecognized by major antivirus software and this provides some degree of stealth.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"meterpreter-flavors\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#meterpreter-flavors\"\u003e\u003c/a\u003eMeterpreter Flavors\u003c/h2\u003e\n\u003cp\u003eStaged payloads are sent to the target in two steps allowing for smaller initial payload size. The inline payloads are sent in a single step.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe stager\u003c/li\u003e\n\u003cli\u003eRequests the rest of the payload\nMeterpreter payloads are divided into staged and inline versions.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eMeterpreter has a wide range of different versions to choose from based on the target system.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003emsfvenom --list payloads | grep meterpreter\u003c/code\u003e to view available Meterpreter versions.\u003c/p\u003e\n\u003cp\u003eThe list will show Meterpreter versions available for the following platforms:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAndroid\u003c/li\u003e\n\u003cli\u003eApple iOS\u003c/li\u003e\n\u003cli\u003eJava\u003c/li\u003e\n\u003cli\u003eLinux\u003c/li\u003e\n\u003cli\u003eOSX\u003c/li\u003e\n\u003cli\u003ePHP\u003c/li\u003e\n\u003cli\u003ePython\u003c/li\u003e\n\u003cli\u003eWindows\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eChoosing a version of Meterpreter to use will be based on three factors:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eTarget operating system (Linux, Mac, or Windows, etc.)\u003c/li\u003e\n\u003cli\u003eComponents available on the target system (Is Python installed, PHP website?)\u003c/li\u003e\n\u003cli\u003eNetwork connection types on the target system (Do they allow TCP connections? HTTPS reverse connections? Are IPv6 addresses are not closely monitored as IPv4 addresses?)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAlso list other available payloads using the \u003ccode\u003eshow payloads\u003c/code\u003e command with any module.\u003c/p\u003e\n\u003ch2 id=\"meterpreter-commands\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#meterpreter-commands\"\u003e\u003c/a\u003eMeterpreter Commands\u003c/h2\u003e\n\u003cp\u003eMeterpreter will provide with three primary categories of tools:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBuilt-in commands\u003c/li\u003e\n\u003cli\u003eMeterpreter tools\u003c/li\u003e\n\u003cli\u003eMeterpreter scripting\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eRunning the \u003ccode\u003ehelp\u003c/code\u003e will show Meterpreter commands for different categories:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCore \u003c/li\u003e\n\u003cli\u003eFile system\u003c/li\u003e\n\u003cli\u003eNetworking \u003c/li\u003e\n\u003cli\u003eSystem \u003c/li\u003e\n\u003cli\u003eUser interface \u003c/li\u003e\n\u003cli\u003eWebcam \u003c/li\u003e\n\u003cli\u003eAudio output\u003c/li\u003e\n\u003cli\u003eElevate\u003c/li\u003e\n\u003cli\u003ePassword database\u003c/li\u003e\n\u003cli\u003eTimestomp\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"core-commands\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#core-commands\"\u003e\u003c/a\u003eCore Commands\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ebackground\u003c/code\u003e: Backgrounds the current session\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eexit\u003c/code\u003e: Terminate the Meterpreter session\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eguid\u003c/code\u003e: Get the session GUID (Globally Unique Identifier)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehelp\u003c/code\u003e: Displays the help menu\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003einfo\u003c/code\u003e: Displays information about a Post module\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eirb\u003c/code\u003e: Opens an interactive Ruby shell on the current session\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eload\u003c/code\u003e: Loads one or more Meterpreter extensions\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emigrate\u003c/code\u003e: Allows to migrate Meterpreter to another process\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erun\u003c/code\u003e: Executes a Meterpreter script or Post module\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esessions\u003c/code\u003e: Quickly switch to another session\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"file-system-commands\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#file-system-commands\"\u003e\u003c/a\u003eFile System Commands\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ecd\u003c/code\u003e: Change directory\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003els\u003c/code\u003e: List files in the current directory (dir will also work)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epwd\u003c/code\u003e: Prints the current working directory\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eedit\u003c/code\u003e: Allow to edit a file\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecat\u003c/code\u003e: Show contents of a file to the screen\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erm\u003c/code\u003e: Delete the specified file\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esearch\u003c/code\u003e: Search for files\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eupload\u003c/code\u003e: Upload a file or directory\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edownload\u003c/code\u003e: Download a file or directory\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"networking-commands\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#networking-commands\"\u003e\u003c/a\u003eNetworking Commands\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003earp\u003c/code\u003e: Displays the host ARP (Address Resolution Protocol) cache\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eifconfig\u003c/code\u003e: Displays network interfaces available on the target system\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enetstat\u003c/code\u003e: Displays the network connections\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eportfwd\u003c/code\u003e: Forwards a local port to a remote service\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eroute\u003c/code\u003e: Allows to view and modify the routing table\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"system-commands\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#system-commands\"\u003e\u003c/a\u003eSystem Commands\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eclearev\u003c/code\u003e: Clears the event logs\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eexecute\u003c/code\u003e: Executes a command\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egetpid\u003c/code\u003e: Shows the current process identifier\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egetuid\u003c/code\u003e: Shows the user that Meterpreter is running as\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekill\u003c/code\u003e: Terminates a process\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epkill\u003c/code\u003e: Terminates processes by name\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eps\u003c/code\u003e: List running processes\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ereboot\u003c/code\u003e: Reboots the remote computer\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eshell\u003c/code\u003e: Drops into a system command shell\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eshutdown\u003c/code\u003e: Shuts down the remote computer\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esysinfo\u003c/code\u003e: Gets information about the remote system, such as OS\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"others-commands-listed-under-different-categories\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#others-commands-listed-under-different-categories\"\u003e\u003c/a\u003eOthers Commands (listed under different categories)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eidletime\u003c/code\u003e: Returns the number of seconds the remote user has been idle\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekeyscan_dump\u003c/code\u003e: Dumps the keystroke buffer\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekeyscan_start\u003c/code\u003e: Starts capturing keystrokes\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekeyscan_stop\u003c/code\u003e: Stops capturing keystrokes\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003escreenshare\u003c/code\u003e: Allows to watch the remote user's desktop in real time\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003escreenshot\u003c/code\u003e: Grabs a screenshot of the interactive desktop\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecord_mic\u003c/code\u003e: Records audio from the default microphone for X seconds\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewebcam_chat\u003c/code\u003e: Starts a video chat\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewebcam_list\u003c/code\u003e: Lists webcams\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewebcam_snap\u003c/code\u003e: Takes a snapshot from the specified webcam\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewebcam_stream\u003c/code\u003e: Plays a video stream from the specified webcam\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egetsystem\u003c/code\u003e: Attempts to elevate privilege to that of a local system\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehashdump\u003c/code\u003e: Dumps the contents of the SAM database\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"post-exploitation-with-meterpreter\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#post-exploitation-with-meterpreter\"\u003e\u003c/a\u003ePost-Exploitation with Meterpreter\u003c/h2\u003e\n\u003cp\u003eMeterpreter provides many useful commands for the post-exploitation phase.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egetuid\u003c/code\u003e command will display the user which Meterpreter is currently running to give an idea of possible privilege level on the target system.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eps\u003c/code\u003e command will list running processes. The PID column gives the PID information to migrate Meterpreter to another process.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"migrate\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#migrate\"\u003e\u003c/a\u003eMigrate\u003c/h3\u003e\n\u003cp\u003eMigrating to another process will help Meterpreter interact with it.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf you see a word process running on the target (e.g. word.exe, notepad.exe, etc.), can migrate to to it and start capturing keystrokes sent by the user to this process.\n\u003cul\u003e\n\u003cli\u003eCareful to lose user privileges from SYSTEM user to a process started by a lower privileged user.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"hashdump\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hashdump\"\u003e\u003c/a\u003eHashdump\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ehashdump\u003c/code\u003e will list the content of the SAM database.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe SAM (Security Account Manager) database stores user's passwords on Windows systems. These passwords are stored in the NTLM (New Technology LAN Manager) format.\n\u003cul\u003e\n\u003cli\u003eWhile not mathematically possible to 'crack' these hashes, can still discover the cleartext password using online NTLM databases or a rainbow table attack.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"search\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#search\"\u003e\u003c/a\u003eSearch\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003esearch\u003c/code\u003e is useful to locate files with potential information.\u003c/p\u003e\n\u003ch3 id=\"shell\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#shell\"\u003e\u003c/a\u003eShell\u003c/h3\u003e\n\u003cp\u003eA regular command-line shell on the target system. Pressing CTRL+Z will return to the Meterpreter shell\u003c/p\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/IBM-cybersecurity/notes/ixopv5geql8hlgkwk20pxow\"\u003eShells\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"3ipqfkgudo2s73dwa256ca0","title":"Brain","desc":"","updated":1654212603514,"created":1651706375099,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a83b284bd096f5e390fe503b2b0b07c7","links":[{"type":"ref","from":{"fname":"root","id":"3ipqfkgudo2s73dwa256ca0","vaultName":"vault"},"value":"cybersecurity","position":{"start":{"line":5,"column":1,"offset":76},"end":{"line":5,"column":19,"offset":94},"indent":[]},"xvault":false,"to":{"fname":"cybersecurity"}}],"anchors":{"welcome-to-tysons-vault":{"type":"header","text":"Welcome to Tyson's Vault!","value":"welcome-to-tysons-vault","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":14,"column":0,"depth":2}},"children":["nkcab8fkftjfz927no2dyac","cl0utj7thwjp7bsmxe4v5va","o9kgllk4dy29wx2figqoz1w","5vhy4yxl34a7p6064a13u49","ce290z98noyy6eb5pniawk9","txeqnq5eaictderxvuifqr6","pn4fankyf3uifous1txqj5m","8ykaxd1qjsjfi1c6zsfq1eq","017vb349bxpq76wq69sai1u","wcuptt9dpzdx06nt9l6myuv","iulpmov883qv6tpqkgvbno8","8ml5picmbrjw3u887mag9dz","pd3512leoloo1qll6fr2j0o","e77elhqi5fhnpz5kdvxeudb","9k9gs0zqcs40mq2fsi5nesj","zegnyfq64amprq2yq9rnu3e","op8gluer5gorswd1xkdwwis","btat806wf3v71jpa11klryx","kldz5ejn1lvhsujdm2nyog7","9gc4nxd14um87nyud8e9ubt","ptonz0zapnutyahjkedfn8f","ixopv5geql8hlgkwk20pxow","3cschspue6elfiqxcd17tul","0f8xutu1gmbnw7xt51tim9v","87sb4tbzuopxpz736rwtx5b","d9ibeadgk68z3q2qjgsqida","woqkmy53oegpxi1ia3jl833","6ltznv32t1szgyl74knpxly","16md0j2hj1k5477uu3kclcb","2o3i5a96njb0vlfr61lslzi"],"parent":null,"data":{},"body":"# Welcome to Tyson's Vault!\n\nThis is my place store all my cool knowledge.\n\n![[cybersecurity]]\n\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":false,"templateHierarchy":"template","enableSmartRefs":true,"dendronVersion":"0.83.0"},"preview":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"logoPath":"https://clipground.com/images/cyber-logo-3.jpg","theme":"dark","siteUrl":"https://tysonnguyen.github.io","assetsPrefix":"/IBM-cybersecurity","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Cybersecurity","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/TysonNguyen/IBM-cybersecurity"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enablePrettyLinks":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"enableTaskNotes":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"5jlm4r7fxj9qpp2xtelvktu"},"buildId":"NXb5WjKoAzTxCthMfgKQk","assetPrefix":"/IBM-cybersecurity","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>