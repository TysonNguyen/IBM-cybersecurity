<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Cryptography Encryption</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Cryptography Encryption"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://tysonnguyen.github.io/IBM-cybersecurity/notes/8ykaxd1qjsjfi1c6zsfq1eq/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="5/21/2022"/><meta property="article:modified_time" content="5/21/2022"/><link rel="canonical" href="https://tysonnguyen.github.io/IBM-cybersecurity/notes/8ykaxd1qjsjfi1c6zsfq1eq/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" as="style"/><link rel="stylesheet" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/IBM-cybersecurity/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/IBM-cybersecurity/_next/static/chunks/webpack-b7a0bb0748951285.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/main-3d5e78ffcdd2778f.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/_app-b0ef1900ae658bfa.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/78-13ae6acd5ce7ca5b.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/373-2f3879190a46a3d9.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/notes/%5Bid%5D-69449972c2a725d8.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_buildManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_ssgManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="cryptography-encryption"><a aria-hidden="true" class="anchor-heading icon-link" href="#cryptography-encryption"></a>Cryptography Encryption</h1>
<h1 id="introduction-to-cryptography"><a aria-hidden="true" class="anchor-heading icon-link" href="#introduction-to-cryptography"></a>Introduction to Cryptography</h1>
<ul class="contains-task-list">
<li class="task-list-item">
<p><input type="checkbox" disabled> Define cryptography and encryption.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> Describe the related Open Web Application Security Project (OWASP) Top 10 project and SANS Institute Top 25 cryptographic weaknesses.</p>
</li>
<li>
<p>Describe encryption and common types of encryption algorithms.</p>
</li>
<li>
<p>Define cryptographic terms including hash function and digital signatures.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> Describe common pitfalls of cryptography.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> Describe the digital state of data: Data at Rest.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> Describe the digital state of data: Data in Use.</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> Describe the digital state of data: Data in Transit.</p>
</li>
</ul>
<hr>
<p>Cryptography
: Encryption and related cryptographic mechanisms (hashing, digital signing) safeguard customer data and its integrity, and prevent unauthorized access to it.</p>
<h2 id="owasp-top-10"><a aria-hidden="true" class="anchor-heading icon-link" href="#owasp-top-10"></a>OWASP Top 10</h2>
<ul>
<li>Missing and faulty crypto consistently appears on OWASP Top 10 list.</li>
</ul>
<h2 id="sans-top-25"><a aria-hidden="true" class="anchor-heading icon-link" href="#sans-top-25"></a>SANS Top 25</h2>
<ul>
<li>Cryptographic weaknesses feature prominently on SANS Top 25 list.</li>
</ul>
<h2 id="crypto-vulnerabilities-in-the-news"><a aria-hidden="true" class="anchor-heading icon-link" href="#crypto-vulnerabilities-in-the-news"></a>Crypto Vulnerabilities in the News</h2>
<ul>
<li>Crypto vulnerabilities frequently contribute to hacks and data leaks.</li>
<li><a href="https://www.bleepingcomputer.com/news/security/twitter-admits-recording-plaintext-passwords-in-internal-logs-just-like-github/">Bug in Twitter internal software led to passwords stored in plaintext.</a></li>
<li><a href="https://www.databreaches.net/coplin-health-systems-notifies-43000-patients-after-laptop-stolen-from-employees-car/">Coplin Health Systems lost control of un-encrypted data of 43,000 patients when a laptop was stolen from an employee's car.</a></li>
</ul>
<hr>
<h2 id="cryptography-basics---terminology"><a aria-hidden="true" class="anchor-heading icon-link" href="#cryptography-basics---terminology"></a>Cryptography Basics - Terminology</h2>
<p>Encryption
: Process of encoding data in a way that only authorized parties can access it.</p>
<ul>
<li>Encryption provides <em>Confidentiality</em>, but not <em>Integrity</em>.</li>
<li>Data can be encrypted
<ul>
<li>At rest</li>
<li>In use</li>
<li>In transit</li>
</ul>
</li>
<li>Sensitive business and personal data should be encrypted <strong>at all times, everywhere.</strong></li>
<li>Importance has risen dramatically in recent years.</li>
</ul>
<h3 id="common-encryption-algorithms"><a aria-hidden="true" class="anchor-heading icon-link" href="#common-encryption-algorithms"></a>Common Encryption Algorithms</h3>
<ul>
<li>Symmetric Key (AES, DES, IDEA, ...)</li>
<li>Public Key (RSA, Elliptic Curve, DH, ...)</li>
</ul>
<p><img src="https://1.bp.blogspot.com/-gyqO5PbitmM/WEMgAFfdMSI/AAAAAAAABD0/SbYlTPkRDEkiUe_Asvpsyst65RFgH6OHQCLcB/s1600/SymmKeyVsPubKey.jpg" alt="encryption"></p>
<p>Hash Function
: Maps data of arbitrary size to data of a fixed size.</p>
<ul>
<li>Hashing provides <em>Integrity</em>, but not <em>Confidentiality</em>.</li>
<li>Original data deliberately hard to reconstruct.</li>
<li>Used for <em>integrity checking</em> and sensitive data storage (e.g. passwords).</li>
</ul>
<p>Data Signature
: A mathematical scheme for verifying the authenticity of digital messages and documents.</p>
<ul>
<li>Uses hashing and public key encryption.</li>
<li>Ensure <em>authentication, non-repudiation, and integrity</em>.</li>
</ul>
<p><img src="https://cdn.educba.com/academy/wp-content/uploads/2019/11/Digital-Signature-Cryptography-2.png" alt="signature"></p>
<hr>
<h2 id="cryptography-pitfalls"><a aria-hidden="true" class="anchor-heading icon-link" href="#cryptography-pitfalls"></a>Cryptography Pitfalls</h2>
<h3 id="missing-encryption-of-data-and-communications"><a aria-hidden="true" class="anchor-heading icon-link" href="#missing-encryption-of-data-and-communications"></a>Missing Encryption of Data and Communications</h3>
<ul>
<li>Products handle sensitive business and personal data.</li>
<li>Data is often the most valuable asset that the business has.</li>
<li>When you store or transmit it in clear text, it can be easily leaked or stolen.</li>
<li>Today, there is no excuse for not encrypting data that is stored or transmitted.</li>
<li>Cryptographic technology is mature, tested, and is available for all environments.</li>
</ul>
<p><strong>RECOMMENDATION</strong> - Encrypt all sensitive data you are handling (and also ensure its integrity).</p>
<ul>
<li>Some product owners do not encrypt stored data because "<em>users don't have access to the file system</em>".</li>
<li>There are plenty of vulnerabilities out there that may allow exposure of files stored on the file system.</li>
<li>Physical machine running the application may be stolen, hard disk can then be accessed directly.</li>
</ul>
<p><strong>RECOMMENDATION</strong> - Have to assume that hte files containing sensitive information may be exposed and analyzed.</p>
<h3 id="implementing-own-crypto"><a aria-hidden="true" class="anchor-heading icon-link" href="#implementing-own-crypto"></a>Implementing Own Crypto</h3>
<ul>
<li>Often, developers use Base64 encoding, simple xor encoding, and similar obfuscation schemes.</li>
<li>Also, see products implement their own cryptographic algorithms.</li>
</ul>
<p><strong>RECOMMENDATION</strong> - Rely on proven cryptography, that was scrutinized by thousands of mathematicians and cryptographers. Follow recommendations of National Institute of Standards and Technology (NIST).</p>
<h3 id="relying-on-algorithms-being-secret"><a aria-hidden="true" class="anchor-heading icon-link" href="#relying-on-algorithms-being-secret"></a>Relying on Algorithms Being Secret</h3>
<ul>
<li>"Attackers will never know our internal algorithms."
<ul>
<li>They can and will be discovered; only a question of motivation.</li>
</ul>
</li>
<li>A whole branch of hacking - <strong>Reverse Engineering</strong> - is devoted to discovering hidden algorithms and data.</li>
<li>Application shipped only in compiled form can be "de-compiled".
<ul>
<li>Attackers may analyze trial/free versions of the product, or get copies on the Dark Web.</li>
</ul>
</li>
</ul>
<p><a href="https://www.clearswift.com/resources/press-releases/new-research-reveals-more-third-employees-willing-sell-private-company-data-and-proprietary">The Clearswift-sponsored survey polled more than 500 internet technology decision makers and 4,000 employees in the United States, Europe, and Australia, and discovered that</a>:</p>
<pre><code>25 percent of employees would sell company data, risking both their jobs and criminal convictions, for less than $8000;
3 percent of employees would sell private information for as little as $155;
18 percent would accept an offer of $1550;
35 percent of employees were open to bribes as the offer reached $77,500;
65 percent of employees said they wouldn’t sell data for any price.
</code></pre>
<ul>
<li>"Security by obscurity" is not a good defense mechanism.
<ul>
<li>All algorithms that keep us safe today are open source and very well-studied: AES, RSA, SHA*, ...</li>
</ul>
</li>
</ul>
<p><strong>RECOMMENDATION</strong> - Always assume that algorithms will be known the the adversary.</p>
<ul>
<li>Kerckhoff's Principle - <em>"A crypto-system should be secure even if everything about the system, except the key, is public knowledge."</em></li>
</ul>
<h3 id="using-hardcodedpredictableweak-keys"><a aria-hidden="true" class="anchor-heading icon-link" href="#using-hardcodedpredictableweak-keys"></a>Using Hardcoded/Predictable/Weak Keys</h3>
<ul>
<li>Not safeguarding keys renders crypto mechanisms useless.</li>
<li>When the passwords and keys hardcoded in the product or stored plaintext in the config file, they can be easily discovered by an attacker.</li>
<li>An easily guessed key can be found by trying commonly used passwords.</li>
<li>When keys are generated randomly, they have to be generated from cryptographically-secure source of randomness, not the regular RNG.</li>
</ul>
<p><strong>RECOMMENDATION</strong> - Rely on hard to guess, randomly generated keys and passwords that are stored securely.</p>
<h3 id="ignoring-encryption-export-regulation-rules"><a aria-hidden="true" class="anchor-heading icon-link" href="#ignoring-encryption-export-regulation-rules"></a>Ignoring Encryption Export Regulation Rules</h3>
<ul>
<li>Encryption is export controlled.</li>
<li>All code that...
<ul>
<li><strong>contains</strong> encryption (closed or open-source).</li>
<li><strong>calls</strong> encryption algorithms in another library or component.</li>
<li><strong>directs</strong> encryption functionality in another product... must be classified for export <strong><em>before</em></strong> being released.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="encrypting-data-at-rest"><a aria-hidden="true" class="anchor-heading icon-link" href="#encrypting-data-at-rest"></a>Encrypting Data at Rest</h2>
<ul>
<li>The rule of thumb is to encrypt all sensitive data at rest: in files, config files, databases, backups.</li>
<li>Symmetric key encryption is most commonly used.</li>
<li>Follow NIST guidelines for selecting appropriate algorithm - Currently it is AES (with CBC mode) and Triple DES.</li>
</ul>
<h2 id="pitfalls-and-recommendations"><a aria-hidden="true" class="anchor-heading icon-link" href="#pitfalls-and-recommendations"></a>Pitfalls and Recommendations</h2>
<ul>
<li>Some algorithms are outdated and no longer considered secure.
<ul>
<li>Examples include DES, RC4, and others.</li>
</ul>
</li>
<li>Use hardcoded/easily guessed/insufficiently random keys.
<ul>
<li>Select cryptographically-random keys, do not reuse keys for different installs.</li>
</ul>
</li>
<li>Storing keys in a clear text in proximity to data they protect ("key under the doormat").
<ul>
<li>Store keys in secure keystores.</li>
</ul>
</li>
<li>Using initialization vectors (IVs) incorrectly.
<ul>
<li>Use a new <em>random</em> IV every time.</li>
</ul>
</li>
<li>Preferable to select the biggest key size you can handle (but watch out for export restrictions).</li>
</ul>
<h2 id="encrypting-data-in-use"><a aria-hidden="true" class="anchor-heading icon-link" href="#encrypting-data-in-use"></a>Encrypting Data in Use</h2>
<ul>
<li>Unfortunately a rarely-followed practice.</li>
<li>Memory could be leaked by attacker.
<ul>
<li>Famous 2014 Heartbleed defect leaked memory of processes that used OpenSSL.</li>
</ul>
</li>
<li>The idea is to keep data encrypted up until it must be used.</li>
<li>Decrypt data as needed, and then promptly erase it in memory after use.</li>
<li>Keep all sensitive data (data, keys, passwords) encrypted except a brief moment of use.</li>
<li>Consider <strong><strong>Homomorphic encryption</strong></strong> if it can be applied to your application.</li>
</ul>
<h2 id="encrypting-data-in-transit"><a aria-hidden="true" class="anchor-heading icon-link" href="#encrypting-data-in-transit"></a>Encrypting Data in Transit</h2>
<ul>
<li>Today, there is no excuse for communicating in clear text.</li>
<li>There is an industry consensus about; Firefox and Chrome now mark HTTP sites as insecure.</li>
<li>Attackers can easily snoop on unprotected communications.</li>
<li>All communications (not just HTTP) should be encrypted, including: RPC, database connections, and others.</li>
<li>TLS/SSL is most commonly used protocol.
<ul>
<li>Public key crypto (RSA, DH) for authentication and key exchange; Symmetric key crypto to encrypt the data.</li>
<li>Server Digital Certificate references certificate authority (CA) and the public key.</li>
</ul>
</li>
<li>Sometimes just symmetric key encryption is employed (but requires pre-sharing of keys).</li>
</ul>
<h2 id="additional-pitfalls"><a aria-hidden="true" class="anchor-heading icon-link" href="#additional-pitfalls"></a>Additional Pitfalls</h2>
<h3 id="using-self-signed-certificates"><a aria-hidden="true" class="anchor-heading icon-link" href="#using-self-signed-certificates"></a>Using self-signed certificates</h3>
<ul>
<li>Less problematic for internal communications but still dangerous.</li>
<li>Use properly generated certificates verified by established CA.</li>
</ul>
<h3 id="accepting-arbitrary-certificates"><a aria-hidden="true" class="anchor-heading icon-link" href="#accepting-arbitrary-certificates"></a>Accepting arbitrary certificates</h3>
<ul>
<li>Attacker can issue their own certificate and snoop on communications (MitM attacks).</li>
<li>Do not accept arbitrary certificates without verification.</li>
</ul>
<h3 id="not-using-certificate-pinning"><a aria-hidden="true" class="anchor-heading icon-link" href="#not-using-certificate-pinning"></a>Not using certificate pinning</h3>
<ul>
<li>Attacker may present a properly generated certificate and still snoop on communications.</li>
<li><em>Certificate pinning</em> can help - presented certificate is checked against a set of expected certificates.</li>
</ul>
<h3 id="using-outdated-versions-of-the-protocol-or-insecure-cipher-suites"><a aria-hidden="true" class="anchor-heading icon-link" href="#using-outdated-versions-of-the-protocol-or-insecure-cipher-suites"></a>Using outdated versions of the protocol or insecure cipher suites</h3>
<ul>
<li>Old versions of SSL/TLS are vulnerable (DROWN, POODLE, BEAST, CRIME, BREACH, and other attacks).</li>
<li>**TLS v1.1-1.3 are safe to use (1.2 is recommended, with 1.3 coming).</li>
<li>Review TLS support; there are tools to help you:
<ul>
<li>Nessus, Qualys SSL Server Test (external only), sslscan, sslyze.</li>
</ul>
</li>
</ul>
<h3 id="allow-tls-downgrade-to-insecure-versions-or-even-to-http"><a aria-hidden="true" class="anchor-heading icon-link" href="#allow-tls-downgrade-to-insecure-versions-or-even-to-http"></a>Allow TLS downgrade to insecure versions, or even to HTTP</h3>
<ul>
<li>Lock down versions of TLS that you support and do not allow downgrade; disable HTTP support altogether.</li>
</ul>
<h3 id="not-safeguarding-private-keys"><a aria-hidden="true" class="anchor-heading icon-link" href="#not-safeguarding-private-keys"></a>Not Safeguarding Private Keys</h3>
<ul>
<li>Do not share private keys between different customers, store them in secure keystores.</li>
</ul>
<h4 id="additional-recommendations"><a aria-hidden="true" class="anchor-heading icon-link" href="#additional-recommendations"></a>Additional Recommendations</h4>
<h5 id="consider-implementing-forward-secrecy"><a aria-hidden="true" class="anchor-heading icon-link" href="#consider-implementing-forward-secrecy"></a>Consider Implementing Forward Secrecy</h5>
<ul>
<li>Some cipher suites protect past sessions against future compromises of secret keys or passwords.</li>
</ul>
<h5 id="do-not-use-compression-under-tls"><a aria-hidden="true" class="anchor-heading icon-link" href="#do-not-use-compression-under-tls"></a>Do not use compression under TLS</h5>
<ul>
<li>CRIME/BREACH attacks showed that using compression with TLS for changing resources may lead to sensitive data exposure.</li>
</ul>
<h5 id="implement-http-strict-transport-security-hsts"><a aria-hidden="true" class="anchor-heading icon-link" href="#implement-http-strict-transport-security-hsts"></a>Implement HTTP Strict Transport Security (HSTS)</h5>
<ul>
<li>Implement Strict-Transport-Security header on all communications.</li>
</ul>
<h5 id="stay-informed-of-latest-security-news"><a aria-hidden="true" class="anchor-heading icon-link" href="#stay-informed-of-latest-security-news"></a>Stay Informed of Latest Security News</h5>
<ul>
<li>A protocol or cipher suite that is secure today may be broken in the future.</li>
</ul>
<hr>
<strong>Children</strong>
<ol>
<li><a href="/IBM-cybersecurity/notes/s4pb2fsqnhn3juvfg31nlx4">Digital Signatures</a></li>
<li><a href="/IBM-cybersecurity/notes/0fne3cpmfljfulwoqcenf7k">Hashing</a></li>
<li><a href="/IBM-cybersecurity/notes/06obwk18k40kw2ywrzqo68q">Quantum Computers</a></li>
</ol></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#introduction-to-cryptography" title="Introduction to Cryptography">Introduction to Cryptography</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#owasp-top-10" title="OWASP Top 10">OWASP Top 10</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sans-top-25" title="SANS Top 25">SANS Top 25</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#crypto-vulnerabilities-in-the-news" title="Crypto Vulnerabilities in the News">Crypto Vulnerabilities in the News</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#cryptography-basics---terminology" title="Cryptography Basics - Terminology">Cryptography Basics - Terminology</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#common-encryption-algorithms" title="Common Encryption Algorithms">Common Encryption Algorithms</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#cryptography-pitfalls" title="Cryptography Pitfalls">Cryptography Pitfalls</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#missing-encryption-of-data-and-communications" title="Missing Encryption of Data and Communications">Missing Encryption of Data and Communications</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#implementing-own-crypto" title="Implementing Own Crypto">Implementing Own Crypto</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#relying-on-algorithms-being-secret" title="Relying on Algorithms Being Secret">Relying on Algorithms Being Secret</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#using-hardcodedpredictableweak-keys" title="Using Hardcoded/Predictable/Weak Keys">Using Hardcoded/Predictable/Weak Keys</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#ignoring-encryption-export-regulation-rules" title="Ignoring Encryption Export Regulation Rules">Ignoring Encryption Export Regulation Rules</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#encrypting-data-at-rest" title="Encrypting Data at Rest">Encrypting Data at Rest</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#pitfalls-and-recommendations" title="Pitfalls and Recommendations">Pitfalls and Recommendations</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#encrypting-data-in-use" title="Encrypting Data in Use">Encrypting Data in Use</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#encrypting-data-in-transit" title="Encrypting Data in Transit">Encrypting Data in Transit</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#additional-pitfalls" title="Additional Pitfalls">Additional Pitfalls</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#using-self-signed-certificates" title="Using self-signed certificates">Using self-signed certificates</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#accepting-arbitrary-certificates" title="Accepting arbitrary certificates">Accepting arbitrary certificates</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#not-using-certificate-pinning" title="Not using certificate pinning">Not using certificate pinning</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#using-outdated-versions-of-the-protocol-or-insecure-cipher-suites" title="Using outdated versions of the protocol or insecure cipher suites">Using outdated versions of the protocol or insecure cipher suites</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#allow-tls-downgrade-to-insecure-versions-or-even-to-http" title="Allow TLS downgrade to insecure versions, or even to HTTP">Allow TLS downgrade to insecure versions, or even to HTTP</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#not-safeguarding-private-keys" title="Not Safeguarding Private Keys">Not Safeguarding Private Keys</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#additional-recommendations" title="Additional Recommendations">Additional Recommendations</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#consider-implementing-forward-secrecy" title="Consider Implementing Forward Secrecy">Consider Implementing Forward Secrecy</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#do-not-use-compression-under-tls" title="Do not use compression under TLS">Do not use compression under TLS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#implement-http-strict-transport-security-hsts" title="Implement HTTP Strict Transport Security (HSTS)">Implement HTTP Strict Transport Security (HSTS)</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#stay-informed-of-latest-security-news" title="Stay Informed of Latest Security News">Stay Informed of Latest Security News</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"8ykaxd1qjsjfi1c6zsfq1eq","title":"Cryptography Encryption","desc":"","updated":1653131984950,"created":1653131979939,"custom":{},"fname":"cryptography-encryption","type":"note","vault":{"fsPath":"vault"},"contentHash":"0ab0bc5b5cf4b0da3b435839dabb1125","links":[],"anchors":{"introduction-to-cryptography":{"type":"header","text":"Introduction to Cryptography","value":"introduction-to-cryptography","line":8,"column":0,"depth":1},"owasp-top-10":{"type":"header","text":"OWASP Top 10","value":"owasp-top-10","line":28,"column":0,"depth":2},"sans-top-25":{"type":"header","text":"SANS Top 25","value":"sans-top-25","line":32,"column":0,"depth":2},"crypto-vulnerabilities-in-the-news":{"type":"header","text":"Crypto Vulnerabilities in the News","value":"crypto-vulnerabilities-in-the-news","line":36,"column":0,"depth":2},"cryptography-basics---terminology":{"type":"header","text":"Cryptography Basics - Terminology","value":"cryptography-basics---terminology","line":44,"column":0,"depth":2},"common-encryption-algorithms":{"type":"header","text":"Common Encryption Algorithms","value":"common-encryption-algorithms","line":57,"column":0,"depth":3},"cryptography-pitfalls":{"type":"header","text":"Cryptography Pitfalls","value":"cryptography-pitfalls","line":81,"column":0,"depth":2},"missing-encryption-of-data-and-communications":{"type":"header","text":"Missing Encryption of Data and Communications","value":"missing-encryption-of-data-and-communications","line":83,"column":0,"depth":3},"implementing-own-crypto":{"type":"header","text":"Implementing Own Crypto","value":"implementing-own-crypto","line":99,"column":0,"depth":3},"relying-on-algorithms-being-secret":{"type":"header","text":"Relying on Algorithms Being Secret","value":"relying-on-algorithms-being-secret","line":106,"column":0,"depth":3},"using-hardcodedpredictableweak-keys":{"type":"header","text":"Using Hardcoded/Predictable/Weak Keys","value":"using-hardcodedpredictableweak-keys","line":129,"column":0,"depth":3},"ignoring-encryption-export-regulation-rules":{"type":"header","text":"Ignoring Encryption Export Regulation Rules","value":"ignoring-encryption-export-regulation-rules","line":138,"column":0,"depth":3},"encrypting-data-at-rest":{"type":"header","text":"Encrypting Data at Rest","value":"encrypting-data-at-rest","line":148,"column":0,"depth":2},"pitfalls-and-recommendations":{"type":"header","text":"Pitfalls and Recommendations","value":"pitfalls-and-recommendations","line":154,"column":0,"depth":2},"encrypting-data-in-use":{"type":"header","text":"Encrypting Data in Use","value":"encrypting-data-in-use","line":166,"column":0,"depth":2},"encrypting-data-in-transit":{"type":"header","text":"Encrypting Data in Transit","value":"encrypting-data-in-transit","line":176,"column":0,"depth":2},"additional-pitfalls":{"type":"header","text":"Additional Pitfalls","value":"additional-pitfalls","line":187,"column":0,"depth":2},"using-self-signed-certificates":{"type":"header","text":"Using self-signed certificates","value":"using-self-signed-certificates","line":189,"column":0,"depth":3},"accepting-arbitrary-certificates":{"type":"header","text":"Accepting arbitrary certificates","value":"accepting-arbitrary-certificates","line":194,"column":0,"depth":3},"not-using-certificate-pinning":{"type":"header","text":"Not using certificate pinning","value":"not-using-certificate-pinning","line":199,"column":0,"depth":3},"using-outdated-versions-of-the-protocol-or-insecure-cipher-suites":{"type":"header","text":"Using outdated versions of the protocol or insecure cipher suites","value":"using-outdated-versions-of-the-protocol-or-insecure-cipher-suites","line":204,"column":0,"depth":3},"allow-tls-downgrade-to-insecure-versions-or-even-to-http":{"type":"header","text":"Allow TLS downgrade to insecure versions, or even to HTTP","value":"allow-tls-downgrade-to-insecure-versions-or-even-to-http","line":211,"column":0,"depth":3},"not-safeguarding-private-keys":{"type":"header","text":"Not Safeguarding Private Keys","value":"not-safeguarding-private-keys","line":215,"column":0,"depth":3},"additional-recommendations":{"type":"header","text":"Additional Recommendations","value":"additional-recommendations","line":219,"column":0,"depth":4},"consider-implementing-forward-secrecy":{"type":"header","text":"Consider Implementing Forward Secrecy","value":"consider-implementing-forward-secrecy","line":221,"column":0,"depth":5},"do-not-use-compression-under-tls":{"type":"header","text":"Do not use compression under TLS","value":"do-not-use-compression-under-tls","line":225,"column":0,"depth":5},"implement-http-strict-transport-security-hsts":{"type":"header","text":"Implement HTTP Strict Transport Security (HSTS)","value":"implement-http-strict-transport-security-hsts","line":229,"column":0,"depth":5},"stay-informed-of-latest-security-news":{"type":"header","text":"Stay Informed of Latest Security News","value":"stay-informed-of-latest-security-news","line":233,"column":0,"depth":5}},"children":["s4pb2fsqnhn3juvfg31nlx4","0fne3cpmfljfulwoqcenf7k","06obwk18k40kw2ywrzqo68q"],"parent":"3ipqfkgudo2s73dwa256ca0","data":{}},"body":"\u003ch1 id=\"cryptography-encryption\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cryptography-encryption\"\u003e\u003c/a\u003eCryptography Encryption\u003c/h1\u003e\n\u003ch1 id=\"introduction-to-cryptography\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#introduction-to-cryptography\"\u003e\u003c/a\u003eIntroduction to Cryptography\u003c/h1\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cp\u003e\u003cinput type=\"checkbox\" disabled\u003e Define cryptography and encryption.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cp\u003e\u003cinput type=\"checkbox\" disabled\u003e Describe the related Open Web Application Security Project (OWASP) Top 10 project and SANS Institute Top 25 cryptographic weaknesses.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDescribe encryption and common types of encryption algorithms.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDefine cryptographic terms including hash function and digital signatures.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cp\u003e\u003cinput type=\"checkbox\" disabled\u003e Describe common pitfalls of cryptography.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cp\u003e\u003cinput type=\"checkbox\" disabled\u003e Describe the digital state of data: Data at Rest.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cp\u003e\u003cinput type=\"checkbox\" disabled\u003e Describe the digital state of data: Data in Use.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cp\u003e\u003cinput type=\"checkbox\" disabled\u003e Describe the digital state of data: Data in Transit.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003eCryptography\n: Encryption and related cryptographic mechanisms (hashing, digital signing) safeguard customer data and its integrity, and prevent unauthorized access to it.\u003c/p\u003e\n\u003ch2 id=\"owasp-top-10\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#owasp-top-10\"\u003e\u003c/a\u003eOWASP Top 10\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eMissing and faulty crypto consistently appears on OWASP Top 10 list.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"sans-top-25\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sans-top-25\"\u003e\u003c/a\u003eSANS Top 25\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eCryptographic weaknesses feature prominently on SANS Top 25 list.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"crypto-vulnerabilities-in-the-news\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#crypto-vulnerabilities-in-the-news\"\u003e\u003c/a\u003eCrypto Vulnerabilities in the News\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eCrypto vulnerabilities frequently contribute to hacks and data leaks.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.bleepingcomputer.com/news/security/twitter-admits-recording-plaintext-passwords-in-internal-logs-just-like-github/\"\u003eBug in Twitter internal software led to passwords stored in plaintext.\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.databreaches.net/coplin-health-systems-notifies-43000-patients-after-laptop-stolen-from-employees-car/\"\u003eCoplin Health Systems lost control of un-encrypted data of 43,000 patients when a laptop was stolen from an employee's car.\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"cryptography-basics---terminology\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cryptography-basics---terminology\"\u003e\u003c/a\u003eCryptography Basics - Terminology\u003c/h2\u003e\n\u003cp\u003eEncryption\n: Process of encoding data in a way that only authorized parties can access it.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEncryption provides \u003cem\u003eConfidentiality\u003c/em\u003e, but not \u003cem\u003eIntegrity\u003c/em\u003e.\u003c/li\u003e\n\u003cli\u003eData can be encrypted\n\u003cul\u003e\n\u003cli\u003eAt rest\u003c/li\u003e\n\u003cli\u003eIn use\u003c/li\u003e\n\u003cli\u003eIn transit\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eSensitive business and personal data should be encrypted \u003cstrong\u003eat all times, everywhere.\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eImportance has risen dramatically in recent years.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"common-encryption-algorithms\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#common-encryption-algorithms\"\u003e\u003c/a\u003eCommon Encryption Algorithms\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eSymmetric Key (AES, DES, IDEA, ...)\u003c/li\u003e\n\u003cli\u003ePublic Key (RSA, Elliptic Curve, DH, ...)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://1.bp.blogspot.com/-gyqO5PbitmM/WEMgAFfdMSI/AAAAAAAABD0/SbYlTPkRDEkiUe_Asvpsyst65RFgH6OHQCLcB/s1600/SymmKeyVsPubKey.jpg\" alt=\"encryption\"\u003e\u003c/p\u003e\n\u003cp\u003eHash Function\n: Maps data of arbitrary size to data of a fixed size.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHashing provides \u003cem\u003eIntegrity\u003c/em\u003e, but not \u003cem\u003eConfidentiality\u003c/em\u003e.\u003c/li\u003e\n\u003cli\u003eOriginal data deliberately hard to reconstruct.\u003c/li\u003e\n\u003cli\u003eUsed for \u003cem\u003eintegrity checking\u003c/em\u003e and sensitive data storage (e.g. passwords).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eData Signature\n: A mathematical scheme for verifying the authenticity of digital messages and documents.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUses hashing and public key encryption.\u003c/li\u003e\n\u003cli\u003eEnsure \u003cem\u003eauthentication, non-repudiation, and integrity\u003c/em\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn.educba.com/academy/wp-content/uploads/2019/11/Digital-Signature-Cryptography-2.png\" alt=\"signature\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"cryptography-pitfalls\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cryptography-pitfalls\"\u003e\u003c/a\u003eCryptography Pitfalls\u003c/h2\u003e\n\u003ch3 id=\"missing-encryption-of-data-and-communications\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#missing-encryption-of-data-and-communications\"\u003e\u003c/a\u003eMissing Encryption of Data and Communications\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eProducts handle sensitive business and personal data.\u003c/li\u003e\n\u003cli\u003eData is often the most valuable asset that the business has.\u003c/li\u003e\n\u003cli\u003eWhen you store or transmit it in clear text, it can be easily leaked or stolen.\u003c/li\u003e\n\u003cli\u003eToday, there is no excuse for not encrypting data that is stored or transmitted.\u003c/li\u003e\n\u003cli\u003eCryptographic technology is mature, tested, and is available for all environments.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eRECOMMENDATION\u003c/strong\u003e - Encrypt all sensitive data you are handling (and also ensure its integrity).\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSome product owners do not encrypt stored data because \"\u003cem\u003eusers don't have access to the file system\u003c/em\u003e\".\u003c/li\u003e\n\u003cli\u003eThere are plenty of vulnerabilities out there that may allow exposure of files stored on the file system.\u003c/li\u003e\n\u003cli\u003ePhysical machine running the application may be stolen, hard disk can then be accessed directly.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eRECOMMENDATION\u003c/strong\u003e - Have to assume that hte files containing sensitive information may be exposed and analyzed.\u003c/p\u003e\n\u003ch3 id=\"implementing-own-crypto\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#implementing-own-crypto\"\u003e\u003c/a\u003eImplementing Own Crypto\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eOften, developers use Base64 encoding, simple xor encoding, and similar obfuscation schemes.\u003c/li\u003e\n\u003cli\u003eAlso, see products implement their own cryptographic algorithms.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eRECOMMENDATION\u003c/strong\u003e - Rely on proven cryptography, that was scrutinized by thousands of mathematicians and cryptographers. Follow recommendations of National Institute of Standards and Technology (NIST).\u003c/p\u003e\n\u003ch3 id=\"relying-on-algorithms-being-secret\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#relying-on-algorithms-being-secret\"\u003e\u003c/a\u003eRelying on Algorithms Being Secret\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\"Attackers will never know our internal algorithms.\"\n\u003cul\u003e\n\u003cli\u003eThey can and will be discovered; only a question of motivation.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eA whole branch of hacking - \u003cstrong\u003eReverse Engineering\u003c/strong\u003e - is devoted to discovering hidden algorithms and data.\u003c/li\u003e\n\u003cli\u003eApplication shipped only in compiled form can be \"de-compiled\".\n\u003cul\u003e\n\u003cli\u003eAttackers may analyze trial/free versions of the product, or get copies on the Dark Web.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://www.clearswift.com/resources/press-releases/new-research-reveals-more-third-employees-willing-sell-private-company-data-and-proprietary\"\u003eThe Clearswift-sponsored survey polled more than 500 internet technology decision makers and 4,000 employees in the United States, Europe, and Australia, and discovered that\u003c/a\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e25 percent of employees would sell company data, risking both their jobs and criminal convictions, for less than $8000;\n3 percent of employees would sell private information for as little as $155;\n18 percent would accept an offer of $1550;\n35 percent of employees were open to bribes as the offer reached $77,500;\n65 percent of employees said they wouldn’t sell data for any price.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\"Security by obscurity\" is not a good defense mechanism.\n\u003cul\u003e\n\u003cli\u003eAll algorithms that keep us safe today are open source and very well-studied: AES, RSA, SHA*, ...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eRECOMMENDATION\u003c/strong\u003e - Always assume that algorithms will be known the the adversary.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eKerckhoff's Principle - \u003cem\u003e\"A crypto-system should be secure even if everything about the system, except the key, is public knowledge.\"\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"using-hardcodedpredictableweak-keys\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#using-hardcodedpredictableweak-keys\"\u003e\u003c/a\u003eUsing Hardcoded/Predictable/Weak Keys\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eNot safeguarding keys renders crypto mechanisms useless.\u003c/li\u003e\n\u003cli\u003eWhen the passwords and keys hardcoded in the product or stored plaintext in the config file, they can be easily discovered by an attacker.\u003c/li\u003e\n\u003cli\u003eAn easily guessed key can be found by trying commonly used passwords.\u003c/li\u003e\n\u003cli\u003eWhen keys are generated randomly, they have to be generated from cryptographically-secure source of randomness, not the regular RNG.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eRECOMMENDATION\u003c/strong\u003e - Rely on hard to guess, randomly generated keys and passwords that are stored securely.\u003c/p\u003e\n\u003ch3 id=\"ignoring-encryption-export-regulation-rules\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#ignoring-encryption-export-regulation-rules\"\u003e\u003c/a\u003eIgnoring Encryption Export Regulation Rules\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eEncryption is export controlled.\u003c/li\u003e\n\u003cli\u003eAll code that...\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003econtains\u003c/strong\u003e encryption (closed or open-source).\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ecalls\u003c/strong\u003e encryption algorithms in another library or component.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edirects\u003c/strong\u003e encryption functionality in another product... must be classified for export \u003cstrong\u003e\u003cem\u003ebefore\u003c/em\u003e\u003c/strong\u003e being released.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"encrypting-data-at-rest\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#encrypting-data-at-rest\"\u003e\u003c/a\u003eEncrypting Data at Rest\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eThe rule of thumb is to encrypt all sensitive data at rest: in files, config files, databases, backups.\u003c/li\u003e\n\u003cli\u003eSymmetric key encryption is most commonly used.\u003c/li\u003e\n\u003cli\u003eFollow NIST guidelines for selecting appropriate algorithm - Currently it is AES (with CBC mode) and Triple DES.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"pitfalls-and-recommendations\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#pitfalls-and-recommendations\"\u003e\u003c/a\u003ePitfalls and Recommendations\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSome algorithms are outdated and no longer considered secure.\n\u003cul\u003e\n\u003cli\u003eExamples include DES, RC4, and others.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eUse hardcoded/easily guessed/insufficiently random keys.\n\u003cul\u003e\n\u003cli\u003eSelect cryptographically-random keys, do not reuse keys for different installs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eStoring keys in a clear text in proximity to data they protect (\"key under the doormat\").\n\u003cul\u003e\n\u003cli\u003eStore keys in secure keystores.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eUsing initialization vectors (IVs) incorrectly.\n\u003cul\u003e\n\u003cli\u003eUse a new \u003cem\u003erandom\u003c/em\u003e IV every time.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ePreferable to select the biggest key size you can handle (but watch out for export restrictions).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"encrypting-data-in-use\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#encrypting-data-in-use\"\u003e\u003c/a\u003eEncrypting Data in Use\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eUnfortunately a rarely-followed practice.\u003c/li\u003e\n\u003cli\u003eMemory could be leaked by attacker.\n\u003cul\u003e\n\u003cli\u003eFamous 2014 Heartbleed defect leaked memory of processes that used OpenSSL.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eThe idea is to keep data encrypted up until it must be used.\u003c/li\u003e\n\u003cli\u003eDecrypt data as needed, and then promptly erase it in memory after use.\u003c/li\u003e\n\u003cli\u003eKeep all sensitive data (data, keys, passwords) encrypted except a brief moment of use.\u003c/li\u003e\n\u003cli\u003eConsider \u003cstrong\u003e\u003cstrong\u003eHomomorphic encryption\u003c/strong\u003e\u003c/strong\u003e if it can be applied to your application.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"encrypting-data-in-transit\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#encrypting-data-in-transit\"\u003e\u003c/a\u003eEncrypting Data in Transit\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eToday, there is no excuse for communicating in clear text.\u003c/li\u003e\n\u003cli\u003eThere is an industry consensus about; Firefox and Chrome now mark HTTP sites as insecure.\u003c/li\u003e\n\u003cli\u003eAttackers can easily snoop on unprotected communications.\u003c/li\u003e\n\u003cli\u003eAll communications (not just HTTP) should be encrypted, including: RPC, database connections, and others.\u003c/li\u003e\n\u003cli\u003eTLS/SSL is most commonly used protocol.\n\u003cul\u003e\n\u003cli\u003ePublic key crypto (RSA, DH) for authentication and key exchange; Symmetric key crypto to encrypt the data.\u003c/li\u003e\n\u003cli\u003eServer Digital Certificate references certificate authority (CA) and the public key.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eSometimes just symmetric key encryption is employed (but requires pre-sharing of keys).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"additional-pitfalls\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#additional-pitfalls\"\u003e\u003c/a\u003eAdditional Pitfalls\u003c/h2\u003e\n\u003ch3 id=\"using-self-signed-certificates\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#using-self-signed-certificates\"\u003e\u003c/a\u003eUsing self-signed certificates\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eLess problematic for internal communications but still dangerous.\u003c/li\u003e\n\u003cli\u003eUse properly generated certificates verified by established CA.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"accepting-arbitrary-certificates\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#accepting-arbitrary-certificates\"\u003e\u003c/a\u003eAccepting arbitrary certificates\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAttacker can issue their own certificate and snoop on communications (MitM attacks).\u003c/li\u003e\n\u003cli\u003eDo not accept arbitrary certificates without verification.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"not-using-certificate-pinning\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#not-using-certificate-pinning\"\u003e\u003c/a\u003eNot using certificate pinning\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAttacker may present a properly generated certificate and still snoop on communications.\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eCertificate pinning\u003c/em\u003e can help - presented certificate is checked against a set of expected certificates.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"using-outdated-versions-of-the-protocol-or-insecure-cipher-suites\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#using-outdated-versions-of-the-protocol-or-insecure-cipher-suites\"\u003e\u003c/a\u003eUsing outdated versions of the protocol or insecure cipher suites\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eOld versions of SSL/TLS are vulnerable (DROWN, POODLE, BEAST, CRIME, BREACH, and other attacks).\u003c/li\u003e\n\u003cli\u003e**TLS v1.1-1.3 are safe to use (1.2 is recommended, with 1.3 coming).\u003c/li\u003e\n\u003cli\u003eReview TLS support; there are tools to help you:\n\u003cul\u003e\n\u003cli\u003eNessus, Qualys SSL Server Test (external only), sslscan, sslyze.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"allow-tls-downgrade-to-insecure-versions-or-even-to-http\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#allow-tls-downgrade-to-insecure-versions-or-even-to-http\"\u003e\u003c/a\u003eAllow TLS downgrade to insecure versions, or even to HTTP\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eLock down versions of TLS that you support and do not allow downgrade; disable HTTP support altogether.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"not-safeguarding-private-keys\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#not-safeguarding-private-keys\"\u003e\u003c/a\u003eNot Safeguarding Private Keys\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDo not share private keys between different customers, store them in secure keystores.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"additional-recommendations\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#additional-recommendations\"\u003e\u003c/a\u003eAdditional Recommendations\u003c/h4\u003e\n\u003ch5 id=\"consider-implementing-forward-secrecy\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#consider-implementing-forward-secrecy\"\u003e\u003c/a\u003eConsider Implementing Forward Secrecy\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eSome cipher suites protect past sessions against future compromises of secret keys or passwords.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"do-not-use-compression-under-tls\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#do-not-use-compression-under-tls\"\u003e\u003c/a\u003eDo not use compression under TLS\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eCRIME/BREACH attacks showed that using compression with TLS for changing resources may lead to sensitive data exposure.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"implement-http-strict-transport-security-hsts\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#implement-http-strict-transport-security-hsts\"\u003e\u003c/a\u003eImplement HTTP Strict Transport Security (HSTS)\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eImplement Strict-Transport-Security header on all communications.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"stay-informed-of-latest-security-news\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#stay-informed-of-latest-security-news\"\u003e\u003c/a\u003eStay Informed of Latest Security News\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eA protocol or cipher suite that is secure today may be broken in the future.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cstrong\u003eChildren\u003c/strong\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"/IBM-cybersecurity/notes/s4pb2fsqnhn3juvfg31nlx4\"\u003eDigital Signatures\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/IBM-cybersecurity/notes/0fne3cpmfljfulwoqcenf7k\"\u003eHashing\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/IBM-cybersecurity/notes/06obwk18k40kw2ywrzqo68q\"\u003eQuantum Computers\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e","noteIndex":{"id":"3ipqfkgudo2s73dwa256ca0","title":"Brain","desc":"","updated":1654212603514,"created":1651706375099,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a83b284bd096f5e390fe503b2b0b07c7","links":[{"type":"ref","from":{"fname":"root","id":"3ipqfkgudo2s73dwa256ca0","vaultName":"vault"},"value":"cybersecurity","position":{"start":{"line":5,"column":1,"offset":76},"end":{"line":5,"column":19,"offset":94},"indent":[]},"xvault":false,"to":{"fname":"cybersecurity"}}],"anchors":{"welcome-to-tysons-vault":{"type":"header","text":"Welcome to Tyson's Vault!","value":"welcome-to-tysons-vault","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":14,"column":0,"depth":2}},"children":["nkcab8fkftjfz927no2dyac","cl0utj7thwjp7bsmxe4v5va","o9kgllk4dy29wx2figqoz1w","5vhy4yxl34a7p6064a13u49","ce290z98noyy6eb5pniawk9","txeqnq5eaictderxvuifqr6","pn4fankyf3uifous1txqj5m","8ykaxd1qjsjfi1c6zsfq1eq","017vb349bxpq76wq69sai1u","wcuptt9dpzdx06nt9l6myuv","iulpmov883qv6tpqkgvbno8","8ml5picmbrjw3u887mag9dz","pd3512leoloo1qll6fr2j0o","e77elhqi5fhnpz5kdvxeudb","9k9gs0zqcs40mq2fsi5nesj","zegnyfq64amprq2yq9rnu3e","op8gluer5gorswd1xkdwwis","btat806wf3v71jpa11klryx","kldz5ejn1lvhsujdm2nyog7","9gc4nxd14um87nyud8e9ubt","ptonz0zapnutyahjkedfn8f","ixopv5geql8hlgkwk20pxow","3cschspue6elfiqxcd17tul","0f8xutu1gmbnw7xt51tim9v","87sb4tbzuopxpz736rwtx5b","d9ibeadgk68z3q2qjgsqida","woqkmy53oegpxi1ia3jl833","6ltznv32t1szgyl74knpxly","16md0j2hj1k5477uu3kclcb","2o3i5a96njb0vlfr61lslzi"],"parent":null,"data":{},"body":"# Welcome to Tyson's Vault!\n\nThis is my place store all my cool knowledge.\n\n![[cybersecurity]]\n\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":false,"templateHierarchy":"template","enableSmartRefs":true,"dendronVersion":"0.83.0"},"preview":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"logoPath":"https://clipground.com/images/cyber-logo-3.jpg","theme":"dark","siteUrl":"https://tysonnguyen.github.io","assetsPrefix":"/IBM-cybersecurity","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Cybersecurity","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/TysonNguyen/IBM-cybersecurity"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enablePrettyLinks":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"enableTaskNotes":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"8ykaxd1qjsjfi1c6zsfq1eq"},"buildId":"NXb5WjKoAzTxCthMfgKQk","assetPrefix":"/IBM-cybersecurity","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>