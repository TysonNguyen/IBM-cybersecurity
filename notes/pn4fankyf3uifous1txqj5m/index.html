<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Command Injection</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Command Injection"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://tysonnguyen.github.io/IBM-cybersecurity/notes/pn4fankyf3uifous1txqj5m/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="7/9/2022"/><meta property="article:modified_time" content="7/9/2022"/><link rel="canonical" href="https://tysonnguyen.github.io/IBM-cybersecurity/notes/pn4fankyf3uifous1txqj5m/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" as="style"/><link rel="stylesheet" href="/IBM-cybersecurity/_next/static/css/0aeb6c71ee87f6df.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/IBM-cybersecurity/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/IBM-cybersecurity/_next/static/chunks/webpack-b7a0bb0748951285.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/main-3d5e78ffcdd2778f.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/_app-b0ef1900ae658bfa.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/78-13ae6acd5ce7ca5b.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/373-2f3879190a46a3d9.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/chunks/pages/notes/%5Bid%5D-69449972c2a725d8.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_buildManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_ssgManifest.js" defer=""></script><script src="/IBM-cybersecurity/_next/static/NXb5WjKoAzTxCthMfgKQk/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="command-injection"><a aria-hidden="true" class="anchor-heading icon-link" href="#command-injection"></a>Command Injection</h1>
<h1 id="what-is-command-injection"><a aria-hidden="true" class="anchor-heading icon-link" href="#what-is-command-injection"></a>What is Command Injection?</h1>
<ul>
<li>How to discover the command injection vulnerability.</li>
<li>How to test and exploit this vulnerability using payloads designed for different operating systems.</li>
<li>How to prevent this vulnerability in an application.</li>
</ul>
<p>Command injection the abuse of an application's behavior to execute commands on the operating system, using the same privileges that the application on a device is running with. If a web server running as a user named <em>joe</em>, it will execute commands under the user and any permissions the account has.</p>
<ul>
<li>Command injection vulnerability is also known as "Remote Code Execution" (RCE) because an attacker can trick the application into executing a series of payloads without direct access to the machine.</li>
<li>Command injection was one of the top ten vulnerabilities reported by Contrast Security's AppSec intelligence report in 2019 and OWASP framework of a web application.</li>
</ul>
<h2 id="discovering-command-injection"><a aria-hidden="true" class="anchor-heading icon-link" href="#discovering-command-injection"></a>Discovering Command Injection</h2>
<p>This vulnerability exists because applications often use functions in programming languages such as PHP, Python, and NodeJS to pass data to an to make system calls on the machine's operating system. For example, taking input from a field and searching for an entry into a file.</p>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/a54a09f7c4efa1d340ab678ece230c44.png" alt="php-injection"></p>
<ol>
<li>The application stores MP3 files in a directory contained on the operating system.</li>
<li>The user inputs the song title to search for. The application stores this input into the <code>$title</code> variable.</li>
<li>The data <code>$title</code> variable is passed to the command <code>grep</code> to search for a text file named <em>songtitle.txt</em> for the entry the user searched for.</li>
<li>The output of this search of <em>songtitle.txt</em> will determine whether the application informs the user that the song exists or not.</li>
</ol>
<p>An attacker could abuse the application by injecting their own commands for the application to execute.</p>
<ul>
<li>Rather than use <code>grep</code> to search for an entry in <code>songtitle.txt</code>, they could ask the application to read data from a more sensitive file.</li>
</ul>
<p>Abusing applications can be possible no matter the programming language the application uses.</p>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/04a1cb87fad0a9b47761afddc48e0bf2.png" alt="python-injection"></p>
<ol>
<li>The 'flask' package is used to set up a web server.</li>
<li>A function that uses the 'subprocess' package to execute a command on the device.</li>
<li>Use a route in the webserver that will execute whatever is provided.</li>
</ol>
<h2 id="exploiting-command-injection"><a aria-hidden="true" class="anchor-heading icon-link" href="#exploiting-command-injection"></a>Exploiting Command Injection</h2>
<p>Applications that use user input to populate system commands with data can often be combined in unintended behavior. For example, the shell operators <code>;</code>, <code>&#x26;</code>, and <code>&#x26;&#x26;</code> will combine two (or more) system commands and execute them both.</p>
<p>Command injection can be detected in two ways:</p>
<ol>
<li><strong>Blind command injection</strong>: There is no direct output from the application when testing payloads. You will have to investigate the behaviors of the application to determine whether or not the payload was successful.</li>
<li><strong>Verbose command injection</strong>: There is direct feedback from the application once you have tested a payload. For example, running the <code>whoami</code> command to see what user the application is running under. The web application will output the username on the page directly.</li>
</ol>
<h3 id="detecting-blind-command-injection"><a aria-hidden="true" class="anchor-heading icon-link" href="#detecting-blind-command-injection"></a>Detecting Blind Command Injection</h3>
<p>There is no output visible, so it is not immediately noticeable when command command injection occurs. A command is executed, but the web application outputs no message.</p>
<p>Must use payloads that will cause some time delay. For example, the <code>ping</code> and <code>sleep</code> commands are significant payloads to test with.</p>
<ul>
<li>Using <code>ping</code>, the application will hang for x amount of seconds in relation to how many pings specified.</li>
<li>Another method to detect blind command injection is by forcing output using redirection operators such as <code>></code>.
<ul>
<li>The web application will execute commands such as <code>whoami</code> and redirect to a file and use <code>cat</code> to read newly created file content.</li>
</ul>
</li>
<li>The <code>curl</code> command is great to test for command injection. <code>curl</code> is used to deliver data to and from an application in your payload.
<ul>
<li><code>curl http://vulnerable.app/process.php%3Fsearch%3DThe%20Beatles%3B%20whoami</code></li>
</ul>
</li>
</ul>
<h3 id="detecting-verbose-command-injection"><a aria-hidden="true" class="anchor-heading icon-link" href="#detecting-verbose-command-injection"></a>Detecting Verbose Command Injection</h3>
<p>Detecting command injection is the easiest method because the application gives you feedback or output to what is happening or being executed.</p>
<ul>
<li>The output of commands such as <code>ping</code> or <code>whoami</code> is directly displayed on the web application.</li>
</ul>
<h3 id="useful-payloads---linux--windows"><a aria-hidden="true" class="anchor-heading icon-link" href="#useful-payloads---linux--windows"></a>Useful Payloads - Linux &#x26; Windows</h3>
<h4 id="linux-payloads"><a aria-hidden="true" class="anchor-heading icon-link" href="#linux-payloads"></a>Linux Payloads</h4>





























<table><thead><tr><th>Payload</th><th>Description</th></tr></thead><tbody><tr><td>whoami</td><td>See what user the application is running under.</td></tr><tr><td>ls</td><td>List the contents of the current directory.</td></tr><tr><td>ping</td><td>Invoke the application to hang. Useful for testing blind command injection.</td></tr><tr><td>sleep</td><td>Useful for blind command injection where the machine does not have <code>ping</code> installed.</td></tr><tr><td>nc</td><td>Netcat can be used to spawn a reverse shell onto the vulnerable application and escalate</td></tr></tbody></table>
<h4 id="windows-payloads"><a aria-hidden="true" class="anchor-heading icon-link" href="#windows-payloads"></a>Windows Payloads</h4>

























<table><thead><tr><th>Payload</th><th>Description</th></tr></thead><tbody><tr><td>whoami</td><td>See what user the application is running under.</td></tr><tr><td>dir</td><td>List the contents of the current directory.</td></tr><tr><td>ping</td><td>Invoke the application to hang. Useful for testing blind command injection.</td></tr><tr><td>timeout</td><td>Invoke the application to hang for blind testing blind command injection if <code>ping</code> is not installed.</td></tr></tbody></table>
<h2 id="remediating-command-injection"><a aria-hidden="true" class="anchor-heading icon-link" href="#remediating-command-injection"></a>Remediating Command Injection</h2>
<p>Command injection can be prevented in a variety of ways. Everything from minimal use of potentially dangerous functions or libraries in a programming language to filtering input without relying on user's input.</p>
<h3 id="vulnerable-functions"><a aria-hidden="true" class="anchor-heading icon-link" href="#vulnerable-functions"></a>Vulnerable Functions</h3>
<p>Below are examples of PHP language, however, the same principles can be extended to many other languages. In PHP, many functions interact with the operating system to execute commands via shell:</p>
<ul>
<li>Exec</li>
<li>Passthru</li>
<li>System</li>
</ul>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/14acf436361fcfb7efced4b2f416b3d5.png" alt="PHP-function"></p>
<ol>
<li>The application will only accept a specific pattern of characters (the digits 0-9).</li>
<li>The application will then only proceed to execute this data which is all numerical.</li>
</ol>
<p>These functions take input such as string or user data and will execute whatever is provided on the system. Any application that uses these functions without proper checks will be vulnerable to command injection.</p>
<h3 id="input-sanitization"><a aria-hidden="true" class="anchor-heading icon-link" href="#input-sanitization"></a>Input Sanitization</h3>
<p>Sanitizing any input from a user that an application uses is a great way to prevent command injection. This is a process of specifying the formats or types of data that a user can submit from numerical data or removing any special characters.</p>
<p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/06e83dfe3791664ed0bb9bc9ffd3e581.png" alt="PHP-sanitization"></p>
<p>The <code>filter_input</code> PHP function is used to check whether or no any data submitted via an input form is a number. If it is not a number, it must be a invalid input.</p>
<h3 id="bypassing-filters"><a aria-hidden="true" class="anchor-heading icon-link" href="#bypassing-filters"></a>Bypassing Filters</h3>
<p>Applications will employ numerous techniques in filtering and sanitizing data from a user's input. We can abuse the logic behind an application to bypass these filters.</p>
<ul>
<li>An application may strip out quotation marks - Instead, use the hexadecimal value of this to achieve the same result.</li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#what-is-command-injection" title="What is Command Injection?">What is Command Injection?</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#discovering-command-injection" title="Discovering Command Injection">Discovering Command Injection</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#exploiting-command-injection" title="Exploiting Command Injection">Exploiting Command Injection</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#detecting-blind-command-injection" title="Detecting Blind Command Injection">Detecting Blind Command Injection</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#detecting-verbose-command-injection" title="Detecting Verbose Command Injection">Detecting Verbose Command Injection</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#useful-payloads---linux--windows" title="Useful Payloads - Linux &amp; Windows">Useful Payloads - Linux &amp; Windows</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#linux-payloads" title="Linux Payloads">Linux Payloads</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#windows-payloads" title="Windows Payloads">Windows Payloads</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#remediating-command-injection" title="Remediating Command Injection">Remediating Command Injection</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#vulnerable-functions" title="Vulnerable Functions">Vulnerable Functions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#input-sanitization" title="Input Sanitization">Input Sanitization</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#bypassing-filters" title="Bypassing Filters">Bypassing Filters</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"pn4fankyf3uifous1txqj5m","title":"Command Injection","desc":"","updated":1657401645152,"created":1657335380410,"custom":{},"fname":"command-injection","type":"note","vault":{"fsPath":"vault"},"contentHash":"def05faf15ddee9e9d4b02e351ded511","links":[],"anchors":{"what-is-command-injection":{"type":"header","text":"What is Command Injection?","value":"what-is-command-injection","line":8,"column":0,"depth":1},"discovering-command-injection":{"type":"header","text":"Discovering Command Injection","value":"discovering-command-injection","line":19,"column":0,"depth":2},"exploiting-command-injection":{"type":"header","text":"Exploiting Command Injection","value":"exploiting-command-injection","line":42,"column":0,"depth":2},"detecting-blind-command-injection":{"type":"header","text":"Detecting Blind Command Injection","value":"detecting-blind-command-injection","line":51,"column":0,"depth":3},"detecting-verbose-command-injection":{"type":"header","text":"Detecting Verbose Command Injection","value":"detecting-verbose-command-injection","line":63,"column":0,"depth":3},"useful-payloads---linux--windows":{"type":"header","text":"Useful Payloads - Linux \u0026 Windows","value":"useful-payloads---linux--windows","line":69,"column":0,"depth":3},"linux-payloads":{"type":"header","text":"Linux Payloads","value":"linux-payloads","line":71,"column":0,"depth":4},"windows-payloads":{"type":"header","text":"Windows Payloads","value":"windows-payloads","line":82,"column":0,"depth":4},"remediating-command-injection":{"type":"header","text":"Remediating Command Injection","value":"remediating-command-injection","line":91,"column":0,"depth":2},"vulnerable-functions":{"type":"header","text":"Vulnerable Functions","value":"vulnerable-functions","line":95,"column":0,"depth":3},"input-sanitization":{"type":"header","text":"Input Sanitization","value":"input-sanitization","line":110,"column":0,"depth":3},"bypassing-filters":{"type":"header","text":"Bypassing Filters","value":"bypassing-filters","line":118,"column":0,"depth":3}},"children":[],"parent":"3ipqfkgudo2s73dwa256ca0","data":{}},"body":"\u003ch1 id=\"command-injection\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#command-injection\"\u003e\u003c/a\u003eCommand Injection\u003c/h1\u003e\n\u003ch1 id=\"what-is-command-injection\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#what-is-command-injection\"\u003e\u003c/a\u003eWhat is Command Injection?\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eHow to discover the command injection vulnerability.\u003c/li\u003e\n\u003cli\u003eHow to test and exploit this vulnerability using payloads designed for different operating systems.\u003c/li\u003e\n\u003cli\u003eHow to prevent this vulnerability in an application.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCommand injection the abuse of an application's behavior to execute commands on the operating system, using the same privileges that the application on a device is running with. If a web server running as a user named \u003cem\u003ejoe\u003c/em\u003e, it will execute commands under the user and any permissions the account has.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCommand injection vulnerability is also known as \"Remote Code Execution\" (RCE) because an attacker can trick the application into executing a series of payloads without direct access to the machine.\u003c/li\u003e\n\u003cli\u003eCommand injection was one of the top ten vulnerabilities reported by Contrast Security's AppSec intelligence report in 2019 and OWASP framework of a web application.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"discovering-command-injection\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#discovering-command-injection\"\u003e\u003c/a\u003eDiscovering Command Injection\u003c/h2\u003e\n\u003cp\u003eThis vulnerability exists because applications often use functions in programming languages such as PHP, Python, and NodeJS to pass data to an to make system calls on the machine's operating system. For example, taking input from a field and searching for an entry into a file.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/a54a09f7c4efa1d340ab678ece230c44.png\" alt=\"php-injection\"\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe application stores MP3 files in a directory contained on the operating system.\u003c/li\u003e\n\u003cli\u003eThe user inputs the song title to search for. The application stores this input into the \u003ccode\u003e$title\u003c/code\u003e variable.\u003c/li\u003e\n\u003cli\u003eThe data \u003ccode\u003e$title\u003c/code\u003e variable is passed to the command \u003ccode\u003egrep\u003c/code\u003e to search for a text file named \u003cem\u003esongtitle.txt\u003c/em\u003e for the entry the user searched for.\u003c/li\u003e\n\u003cli\u003eThe output of this search of \u003cem\u003esongtitle.txt\u003c/em\u003e will determine whether the application informs the user that the song exists or not.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAn attacker could abuse the application by injecting their own commands for the application to execute.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRather than use \u003ccode\u003egrep\u003c/code\u003e to search for an entry in \u003ccode\u003esongtitle.txt\u003c/code\u003e, they could ask the application to read data from a more sensitive file.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAbusing applications can be possible no matter the programming language the application uses.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/04a1cb87fad0a9b47761afddc48e0bf2.png\" alt=\"python-injection\"\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe 'flask' package is used to set up a web server.\u003c/li\u003e\n\u003cli\u003eA function that uses the 'subprocess' package to execute a command on the device.\u003c/li\u003e\n\u003cli\u003eUse a route in the webserver that will execute whatever is provided.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"exploiting-command-injection\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#exploiting-command-injection\"\u003e\u003c/a\u003eExploiting Command Injection\u003c/h2\u003e\n\u003cp\u003eApplications that use user input to populate system commands with data can often be combined in unintended behavior. For example, the shell operators \u003ccode\u003e;\u003c/code\u003e, \u003ccode\u003e\u0026#x26;\u003c/code\u003e, and \u003ccode\u003e\u0026#x26;\u0026#x26;\u003c/code\u003e will combine two (or more) system commands and execute them both.\u003c/p\u003e\n\u003cp\u003eCommand injection can be detected in two ways:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eBlind command injection\u003c/strong\u003e: There is no direct output from the application when testing payloads. You will have to investigate the behaviors of the application to determine whether or not the payload was successful.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVerbose command injection\u003c/strong\u003e: There is direct feedback from the application once you have tested a payload. For example, running the \u003ccode\u003ewhoami\u003c/code\u003e command to see what user the application is running under. The web application will output the username on the page directly.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"detecting-blind-command-injection\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#detecting-blind-command-injection\"\u003e\u003c/a\u003eDetecting Blind Command Injection\u003c/h3\u003e\n\u003cp\u003eThere is no output visible, so it is not immediately noticeable when command command injection occurs. A command is executed, but the web application outputs no message.\u003c/p\u003e\n\u003cp\u003eMust use payloads that will cause some time delay. For example, the \u003ccode\u003eping\u003c/code\u003e and \u003ccode\u003esleep\u003c/code\u003e commands are significant payloads to test with.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUsing \u003ccode\u003eping\u003c/code\u003e, the application will hang for x amount of seconds in relation to how many pings specified.\u003c/li\u003e\n\u003cli\u003eAnother method to detect blind command injection is by forcing output using redirection operators such as \u003ccode\u003e\u003e\u003c/code\u003e.\n\u003cul\u003e\n\u003cli\u003eThe web application will execute commands such as \u003ccode\u003ewhoami\u003c/code\u003e and redirect to a file and use \u003ccode\u003ecat\u003c/code\u003e to read newly created file content.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003ecurl\u003c/code\u003e command is great to test for command injection. \u003ccode\u003ecurl\u003c/code\u003e is used to deliver data to and from an application in your payload.\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ecurl http://vulnerable.app/process.php%3Fsearch%3DThe%20Beatles%3B%20whoami\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"detecting-verbose-command-injection\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#detecting-verbose-command-injection\"\u003e\u003c/a\u003eDetecting Verbose Command Injection\u003c/h3\u003e\n\u003cp\u003eDetecting command injection is the easiest method because the application gives you feedback or output to what is happening or being executed.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe output of commands such as \u003ccode\u003eping\u003c/code\u003e or \u003ccode\u003ewhoami\u003c/code\u003e is directly displayed on the web application.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"useful-payloads---linux--windows\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#useful-payloads---linux--windows\"\u003e\u003c/a\u003eUseful Payloads - Linux \u0026#x26; Windows\u003c/h3\u003e\n\u003ch4 id=\"linux-payloads\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#linux-payloads\"\u003e\u003c/a\u003eLinux Payloads\u003c/h4\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003ePayload\u003c/th\u003e\u003cth\u003eDescription\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003ewhoami\u003c/td\u003e\u003ctd\u003eSee what user the application is running under.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003els\u003c/td\u003e\u003ctd\u003eList the contents of the current directory.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eping\u003c/td\u003e\u003ctd\u003eInvoke the application to hang. Useful for testing blind command injection.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003esleep\u003c/td\u003e\u003ctd\u003eUseful for blind command injection where the machine does not have \u003ccode\u003eping\u003c/code\u003e installed.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003enc\u003c/td\u003e\u003ctd\u003eNetcat can be used to spawn a reverse shell onto the vulnerable application and escalate\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003ch4 id=\"windows-payloads\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#windows-payloads\"\u003e\u003c/a\u003eWindows Payloads\u003c/h4\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003ePayload\u003c/th\u003e\u003cth\u003eDescription\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003ewhoami\u003c/td\u003e\u003ctd\u003eSee what user the application is running under.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003edir\u003c/td\u003e\u003ctd\u003eList the contents of the current directory.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eping\u003c/td\u003e\u003ctd\u003eInvoke the application to hang. Useful for testing blind command injection.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003etimeout\u003c/td\u003e\u003ctd\u003eInvoke the application to hang for blind testing blind command injection if \u003ccode\u003eping\u003c/code\u003e is not installed.\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003ch2 id=\"remediating-command-injection\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#remediating-command-injection\"\u003e\u003c/a\u003eRemediating Command Injection\u003c/h2\u003e\n\u003cp\u003eCommand injection can be prevented in a variety of ways. Everything from minimal use of potentially dangerous functions or libraries in a programming language to filtering input without relying on user's input.\u003c/p\u003e\n\u003ch3 id=\"vulnerable-functions\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#vulnerable-functions\"\u003e\u003c/a\u003eVulnerable Functions\u003c/h3\u003e\n\u003cp\u003eBelow are examples of PHP language, however, the same principles can be extended to many other languages. In PHP, many functions interact with the operating system to execute commands via shell:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eExec\u003c/li\u003e\n\u003cli\u003ePassthru\u003c/li\u003e\n\u003cli\u003eSystem\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/14acf436361fcfb7efced4b2f416b3d5.png\" alt=\"PHP-function\"\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe application will only accept a specific pattern of characters (the digits 0-9).\u003c/li\u003e\n\u003cli\u003eThe application will then only proceed to execute this data which is all numerical.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThese functions take input such as string or user data and will execute whatever is provided on the system. Any application that uses these functions without proper checks will be vulnerable to command injection.\u003c/p\u003e\n\u003ch3 id=\"input-sanitization\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#input-sanitization\"\u003e\u003c/a\u003eInput Sanitization\u003c/h3\u003e\n\u003cp\u003eSanitizing any input from a user that an application uses is a great way to prevent command injection. This is a process of specifying the formats or types of data that a user can submit from numerical data or removing any special characters.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/06e83dfe3791664ed0bb9bc9ffd3e581.png\" alt=\"PHP-sanitization\"\u003e\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003efilter_input\u003c/code\u003e PHP function is used to check whether or no any data submitted via an input form is a number. If it is not a number, it must be a invalid input.\u003c/p\u003e\n\u003ch3 id=\"bypassing-filters\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#bypassing-filters\"\u003e\u003c/a\u003eBypassing Filters\u003c/h3\u003e\n\u003cp\u003eApplications will employ numerous techniques in filtering and sanitizing data from a user's input. We can abuse the logic behind an application to bypass these filters.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAn application may strip out quotation marks - Instead, use the hexadecimal value of this to achieve the same result.\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"3ipqfkgudo2s73dwa256ca0","title":"Brain","desc":"","updated":1654212603514,"created":1651706375099,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a83b284bd096f5e390fe503b2b0b07c7","links":[{"type":"ref","from":{"fname":"root","id":"3ipqfkgudo2s73dwa256ca0","vaultName":"vault"},"value":"cybersecurity","position":{"start":{"line":5,"column":1,"offset":76},"end":{"line":5,"column":19,"offset":94},"indent":[]},"xvault":false,"to":{"fname":"cybersecurity"}}],"anchors":{"welcome-to-tysons-vault":{"type":"header","text":"Welcome to Tyson's Vault!","value":"welcome-to-tysons-vault","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":14,"column":0,"depth":2}},"children":["nkcab8fkftjfz927no2dyac","cl0utj7thwjp7bsmxe4v5va","o9kgllk4dy29wx2figqoz1w","5vhy4yxl34a7p6064a13u49","ce290z98noyy6eb5pniawk9","txeqnq5eaictderxvuifqr6","pn4fankyf3uifous1txqj5m","8ykaxd1qjsjfi1c6zsfq1eq","017vb349bxpq76wq69sai1u","wcuptt9dpzdx06nt9l6myuv","iulpmov883qv6tpqkgvbno8","8ml5picmbrjw3u887mag9dz","pd3512leoloo1qll6fr2j0o","e77elhqi5fhnpz5kdvxeudb","9k9gs0zqcs40mq2fsi5nesj","zegnyfq64amprq2yq9rnu3e","op8gluer5gorswd1xkdwwis","btat806wf3v71jpa11klryx","kldz5ejn1lvhsujdm2nyog7","9gc4nxd14um87nyud8e9ubt","ptonz0zapnutyahjkedfn8f","ixopv5geql8hlgkwk20pxow","3cschspue6elfiqxcd17tul","0f8xutu1gmbnw7xt51tim9v","87sb4tbzuopxpz736rwtx5b","d9ibeadgk68z3q2qjgsqida","woqkmy53oegpxi1ia3jl833","6ltznv32t1szgyl74knpxly","16md0j2hj1k5477uu3kclcb","2o3i5a96njb0vlfr61lslzi"],"parent":null,"data":{},"body":"# Welcome to Tyson's Vault!\n\nThis is my place store all my cool knowledge.\n\n![[cybersecurity]]\n\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":false,"templateHierarchy":"template","enableSmartRefs":true,"dendronVersion":"0.83.0"},"preview":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"logoPath":"https://clipground.com/images/cyber-logo-3.jpg","theme":"dark","siteUrl":"https://tysonnguyen.github.io","assetsPrefix":"/IBM-cybersecurity","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Cybersecurity","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/TysonNguyen/IBM-cybersecurity"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enablePrettyLinks":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"enableTaskNotes":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"pn4fankyf3uifous1txqj5m"},"buildId":"NXb5WjKoAzTxCthMfgKQk","assetPrefix":"/IBM-cybersecurity","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>